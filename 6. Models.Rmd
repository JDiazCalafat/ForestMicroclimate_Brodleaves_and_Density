# GAMMs

*Code reproducibility*

To allow a better reproducibility of this script, we recommend to use checkpoint() set at 2022-11-21. This allows to install and use the packages that were available and run at the time of making this script.

```{r}
#install.packages("checkpoint")
library(checkpoint)
checkpoint("2022-11-21")
```

Load packages:

```{r}
library(lubridate)
library(gamm4)
library(dplyr)
library(RColorBrewer)
library(stringr)
library(corrplot)
```

Load data:

```{r}
tree.temp <- read.csv("./DATASETS/tree_temp.csv", header = TRUE)
```

Calculate month:

```{r}
tree.temp$month <- month(tree.temp$Date)
tree.temp$Day <- day(tree.temp$Date)
```

Remove all column variables for data between 10 and 20 m radius:

```{r}
tree.temp <- tree.temp[,which(colnames(tree.temp) %in% c("site", "Plot", "Date", "location", "month", "Temp.mean", "Temp.min", "Temp.max", "Temp.sd", "era5_meanair", "era5_maxair", "era5_minair", "era5_meansoil", "air_meanoff_ERA5", "air_minoff_ERA5", "air_maxoff_ERA5", "soil_meanoff_ERA5", "Basal_Area_20m", "Basal_Area_19m", "Basal_Area_18m", "Basal_Area_17m", "Basal_Area_16m", "Basal_Area_15m", "Basal_Area_14m", "Basal_Area_13m" ,"Basal_Area_12m", "Basal_Area_11m", "Basal_Area_10m", "Basal_Area_09m", "Basal_Area_08m", "Basal_Area_07m", "Basal_Area_06m", "Basal_Area_05m", "Basal_Area_04m","CanOpen", "era5_prev_av_temp", "mcera5_prev_av_temp", "era5_wind", "perc_broad_20m", "perc_broad_19m", "perc_broad_18m", "perc_broad_17m", "perc_broad_16m", "perc_broad_15m", "perc_broad_14m", "perc_broad_13m", "perc_broad_12m", "perc_broad_11m", "perc_broad_10m", "perc_broad_09m", "perc_broad_08m", "perc_broad_07m", "perc_broad_06m", "perc_broad_05m", "perc_broad_04m", "era5_snow", "era5_prev_av_prec", "mcera5_prev_av_prec", "ws_prev_av_temp", "air_meanoff_ERA5", "air_minoff_ERA5", "air_maxoff_ERA5_ERA5", "air_meanoff_mcera5", "air_minoff_mcera5", "air_maxoff_mcera5", "air_meanoff_ws", "air_minoff_ws", "air_maxoff_ws", "Day", "soil_meanoff_ERA5"))]
```

Separate air and soil loggers:

```{r}
tree.temp.a <- tree.temp[which(tree.temp$location == "a"),]
tree.temp.s <- tree.temp[which(tree.temp$location == "s"),]
```

And Warmest and coldest month:

```{r}
tree.temp.a.jul <- tree.temp.a[which(tree.temp.a$month == 7),]
tree.temp.a.jan <- tree.temp.a[which(tree.temp.a$month == 1),]

tree.temp.s.jul <- tree.temp.s[which(tree.temp.s$month == 7),]
tree.temp.s.jan <- tree.temp.s[which(tree.temp.s$month == 1),]
```

# Models with ERA5 offsets

Models will be run with air temperature offsets calculated from weather station data, as well as those calculated from ERA5 data and distance weighing through the 'mcera5' R package.

LMMs and GAMMs will be run separately. Then, different smoother configurations will be tested for the GAMMs.

## Soil ERA5 models:

### Only linear, with and without interaction:

```{r}
tree.temp.s.jul$autocorr <- as.integer(paste(day(tree.temp.s.jul$Date), year(tree.temp.s.jul$Date), sep = "")) # temporal autocorrelation correction factor
tree.temp.s.jan$autocorr <- as.integer(paste(day(tree.temp.s.jan$Date), year(tree.temp.s.jan$Date), sep = "")) # temporal autocorrelation correction factor

# Canopy openness as a proxy for forest density
model.soil.jul.co.lininteract <- gamm4(soil_meanoff_ERA5 ~ CanOpen*perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.s.jul)

summary(model.soil.jul.co.lininteract$gam)
AIC(model.soil.jul.co.lininteract$mer)

model.soil.jul.co.linadd <- gamm4(soil_meanoff_ERA5 ~ CanOpen + perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.s.jul)

summary(model.soil.jul.co.linadd$gam)
AIC(model.soil.jul.co.linadd$mer)

model.soil.jan.co.lininteract <- gamm4(soil_meanoff_ERA5 ~ CanOpen*perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.s.jan)

summary(model.soil.jan.co.lininteract$gam)
AIC(model.soil.jan.co.lininteract$mer)

model.soil.jan.co.linadd <- gamm4(soil_meanoff_ERA5 ~ CanOpen + perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.s.jan)

summary(model.soil.jan.co.linadd$gam)
AIC(model.soil.jan.co.linadd$mer)


# Basal area as a proxy for forest density
model.soil.jul.ba.lininteract <- gamm4(soil_meanoff_ERA5 ~ Basal_Area_20m*perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.s.jul)

summary(model.soil.jul.ba.lininteract$gam)
AIC(model.soil.jul.ba.lininteract$mer)

model.soil.jul.ba.linadd <- gamm4(soil_meanoff_ERA5 ~ Basal_Area_20m + perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.s.jul)

summary(model.soil.jul.ba.linadd$gam)
AIC(model.soil.jul.ba.linadd$mer)

model.soil.jan.ba.lininteract <- gamm4(soil_meanoff_ERA5 ~ Basal_Area_20m*perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.s.jan)

summary(model.soil.jan.ba.lininteract$gam)
AIC(model.soil.jan.ba.lininteract$mer)

model.soil.jan.ba.linadd <- gamm4(soil_meanoff_ERA5 ~ Basal_Area_20m + perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.s.jan)

summary(model.soil.jan.ba.linadd$gam)
AIC(model.soil.jan.ba.linadd$mer)
```

Save the model's R squared adjusted and AIC:

```{r}
# Function to extract the formula, R sq, AIC, the variable used as a proxy for forest density and the radio used to calculate the 
GAMM_r2aic <- function(model){
  x <- as.character(model$gam$formula)
  formula <- paste(x[2], x[1], x[3], sep="")
  rsq <- round(summary(model$gam)$r.sq,2)
  aic <- round(AIC(model$mer),2)
  forest.density <- if(grepl("CanOpen", formula) == TRUE){
    "Canopy openness"} else {"Basal Area"}
  broadleaves.radio <- str_sub(formula, start = str_locate(formula, "perc_broad_")[2]+1, end = str_locate(formula, "perc_broad_")[2]+3)
  basalarea.radio <- str_sub(formula, start = str_locate(formula, "Basal_Area_")[2]+1, end = str_locate(formula, "Basal_Area_")[2]+3)
  
  dataframe <- data.frame(formula, forest.density, broadleaves.radio, basalarea.radio, rsq, aic)
    
  return(dataframe)
}

output1 <- rbind(GAMM_r2aic(model.soil.jan.ba.lininteract),
                 GAMM_r2aic(model.soil.jan.ba.linadd),
                 GAMM_r2aic(model.soil.jan.co.lininteract),
                 GAMM_r2aic(model.soil.jan.co.linadd))

output1$month <- "Coldest month" #add month
output1$location <- "Soil" #add temp origin
output1$resp.var <- "mean temp" #add response variable

output2 <- rbind(GAMM_r2aic(model.soil.jul.ba.lininteract),
                 GAMM_r2aic(model.soil.jul.ba.linadd),
                 GAMM_r2aic(model.soil.jul.co.lininteract),
                 GAMM_r2aic(model.soil.jul.co.linadd))

output2$month <- "Warmest month" #add month
output2$location <- "Soil" #add temp origin
output2$resp.var <- "mean temp" #add response variable
```

### Different smoother configurations

```{r}
tree.temp.s.jul$site <- as.factor(tree.temp.s.jul$site)
tree.temp.s.jan$site <- as.factor(tree.temp.s.jan$site)

# Warmest month + canopy openness:
soilmodel1 <- gamm4(soil_meanoff_ERA5 ~ s(CanOpen,perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.s.jul)

summary(soilmodel1$gam)
AIC(soilmodel1$mer)

soilmodel2 <- gamm4(soil_meanoff_ERA5 ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

summary(soilmodel2$gam)
AIC(soilmodel2$mer)

soilmodel3 <- gamm4(soil_meanoff_ERA5 ~ s(CanOpen) + s(perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.s.jul)

summary(soilmodel3$gam)
AIC(soilmodel3$mer)

soilmodel4 <- gamm4(soil_meanoff_ERA5 ~ s(CanOpen) + s(perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

summary(soilmodel4$gam)
AIC(soilmodel4$mer)

soilmodel5 <- gamm4(soil_meanoff_ERA5 ~ s(CanOpen, perc_broad_20m, by = site) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.s.jul)

summary(soilmodel5$gam)
AIC(soilmodel5$mer)

soilmodel6 <- gamm4(soil_meanoff_ERA5 ~ s(CanOpen, perc_broad_20m, by = site) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

summary(soilmodel6$gam)
AIC(soilmodel6$mer)

# Warmest month + basal area:
soilmodel7 <- gamm4(soil_meanoff_ERA5 ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.s.jul)

summary(soilmodel7$gam)
AIC(soilmodel7$mer)

soilmodel8 <- gamm4(soil_meanoff_ERA5 ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

summary(soilmodel8$gam)
AIC(soilmodel8$mer)

soilmodel9 <- gamm4(soil_meanoff_ERA5 ~ s(Basal_Area_20m) + s(perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.s.jul)

summary(soilmodel9$gam)
AIC(soilmodel9$mer)

soilmodel10 <- gamm4(soil_meanoff_ERA5 ~ s(Basal_Area_20m) + s(perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

summary(soilmodel10$gam)
AIC(soilmodel10$mer)

soilmodel11 <- gamm4(soil_meanoff_ERA5 ~ s(Basal_Area_20m, perc_broad_20m, by = site) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.s.jul)

summary(soilmodel11$gam)
AIC(soilmodel11$mer)

soilmodel12 <- gamm4(soil_meanoff_ERA5 ~ s(Basal_Area_20m, perc_broad_20m, by = site) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

summary(soilmodel12$gam)
AIC(soilmodel12$mer)

# Save models
output3 <- rbind(GAMM_r2aic(soilmodel1),
                 GAMM_r2aic(soilmodel2),
                 GAMM_r2aic(soilmodel3),
                 GAMM_r2aic(soilmodel4),
                 GAMM_r2aic(soilmodel5),
                 GAMM_r2aic(soilmodel6),
                 GAMM_r2aic(soilmodel7),
                 GAMM_r2aic(soilmodel8),
                 GAMM_r2aic(soilmodel9),
                 GAMM_r2aic(soilmodel10),
                 GAMM_r2aic(soilmodel11),
                 GAMM_r2aic(soilmodel12))

output3$month <- "Warmest month" #add month
output3$location <- "Soil" #add temp origin
output3$resp.var <- "mean temp" #add response variable

# Coldest month + canopy openness:
soilmodel13 <- gamm4(soil_meanoff_ERA5 ~ s(CanOpen,perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.s.jan)

summary(soilmodel13$gam)
AIC(soilmodel13$mer)

soilmodel14 <- gamm4(soil_meanoff_ERA5 ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

summary(soilmodel14$gam)
AIC(soilmodel14$mer)

soilmodel15 <- gamm4(soil_meanoff_ERA5 ~ s(CanOpen) + s(perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.s.jan)

summary(soilmodel15$gam)
AIC(soilmodel15$mer)

soilmodel16 <- gamm4(soil_meanoff_ERA5 ~ s(CanOpen) + s(perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

summary(soilmodel16$gam)
AIC(soilmodel16$mer)

soilmodel17 <- gamm4(soil_meanoff_ERA5 ~ s(CanOpen, perc_broad_20m, by = site) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.s.jan)

summary(soilmodel17$gam)
AIC(soilmodel17$mer)

soilmodel18 <- gamm4(soil_meanoff_ERA5 ~ s(CanOpen, perc_broad_20m, by = site) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

summary(soilmodel18$gam)
AIC(soilmodel18$mer)

# Coldest month + basal area:
soilmodel19 <- gamm4(soil_meanoff_ERA5 ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.s.jan)

summary(soilmodel19$gam)
AIC(soilmodel19$mer)

soilmodel20 <- gamm4(soil_meanoff_ERA5 ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

summary(soilmodel20$gam)
AIC(soilmodel20$mer)

soilmodel21 <- gamm4(soil_meanoff_ERA5 ~ s(Basal_Area_20m) + s(perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.s.jan)

summary(soilmodel21$gam)
AIC(soilmodel21$mer)

soilmodel22 <- gamm4(soil_meanoff_ERA5 ~ s(Basal_Area_20m) + s(perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

summary(soilmodel22$gam)
AIC(soilmodel22$mer)

soilmodel23 <- gamm4(soil_meanoff_ERA5 ~ s(Basal_Area_20m, perc_broad_20m, by = site) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.s.jan)

summary(soilmodel23$gam)
AIC(soilmodel23$mer)

soilmodel24 <- gamm4(soil_meanoff_ERA5 ~ s(Basal_Area_20m, perc_broad_20m, by = site) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

summary(soilmodel24$gam)
AIC(soilmodel24$mer)

output4 <- rbind(GAMM_r2aic(soilmodel13),
                 GAMM_r2aic(soilmodel14),
                 GAMM_r2aic(soilmodel15),
                 GAMM_r2aic(soilmodel16),
                 GAMM_r2aic(soilmodel17),
                 GAMM_r2aic(soilmodel18),
                 GAMM_r2aic(soilmodel19),
                 GAMM_r2aic(soilmodel20),
                 GAMM_r2aic(soilmodel21),
                 GAMM_r2aic(soilmodel22),
                 GAMM_r2aic(soilmodel23),
                 GAMM_r2aic(soilmodel24))

output4$month <- "Coldest month" #add month
output4$location <- "Soil" #add temp origin
output4$resp.var <- "mean temp" #add response variable
```

### Adding covariates:

First we should check for correlation between our covariates:

```{r}
# soil temp in January

cor.s.jan <- cor(tree.temp.s.jan[,which(colnames(tree.temp.s.jan) %in% c("era5_wind", "era5_snow", "era5_prev_av_temp", "era5_prev_av_prec", "CanOpen", "perc_broad_20m", "Basal_Area_20m"))], use = "na.or.complete", method = "spearman")

corrplot(cor.s.jan, method = 'ellipse', order = 'AOE', type = 'upper', addCoef.col ='black', number.cex = 0.5)

# soil temp in July - removing snow covariate

cor.s.jul <- cor(tree.temp.s.jul[,which(colnames(tree.temp.s.jul) %in% c("era5_wind", "era5_prev_av_temp", "era5_prev_av_prec", "CanOpen", "perc_broad_20m", "Basal_Area_20m"))], method = "spearman")

corrplot(cor.s.jul, method = 'ellipse', order = 'AOE', type = 'upper', addCoef.col ='black', number.cex = 0.5)

```

Nothing to worry about. Snow and previous averaged temperature are somewhat highly correlated, but we will anyway include both of them in the models.

Now the models: we will add previous averaged temperature and snow covariates.

#### Coldest month

We will add date (= *autocorr*) within a single smoother to account for temporal autocorrelation.

```{r}
# canopy openness
model.soil.jan.co.all <- gamm4(soil_meanoff_ERA5 ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site + era5_snow + era5_prev_av_temp, random = ~ (1|site:Plot), data = tree.temp.s.jan)

summary(model.soil.jan.co.all$gam)
AIC(model.soil.jan.co.all$mer)

gam.check(model.soil.jan.co.all$gam)

# basal area
model.soil.jan.ba.all <- gamm4(soil_meanoff_ERA5 ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site + era5_snow + era5_prev_av_temp, random = ~ (1|site:Plot), data = tree.temp.s.jan)

summary(model.soil.jan.ba.all$gam)
AIC(model.soil.jan.ba.all$mer)

gam.check(model.soil.jan.ba.all$gam)

colfunc <- colorRampPalette(c("#579dc8", "#ffff73", "#fb2e0e")) # create a color palette to be used as a heatmap

# plot: canopy openness

plot(model.soil.jan.co.all$gam, scheme = 2, lwd = 3, main = "Average soil temp offset coldest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select =1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# plot: basal area
plot(model.soil.jan.ba.all$gam, scheme = 2, lwd = 3, main = "Average soil temp offset coldest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select =1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Save output
output5 <- rbind(GAMM_r2aic(model.soil.jan.co.all),
                 GAMM_r2aic(model.soil.jan.ba.all))

output5$month <- "Coldest month" #add month
output5$location <- "Soil" #add temp origin
output5$resp.var <- "mean temp" #add response variable
```

#### Warmest month

Same approach:

```{r}
# canopy openness
model.soil.jul.co.all <- gamm4(soil_meanoff_ERA5 ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site + era5_prev_av_temp, random = ~ (1|site:Plot), data = tree.temp.s.jul)

summary(model.soil.jul.co.all$gam)
AIC(model.soil.jul.co.all$mer)

gam.check(model.soil.jul.co.all$gam)

# basal area
model.soil.jul.ba.all <- gamm4(soil_meanoff_ERA5 ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site + era5_prev_av_temp, random = ~ (1|site:Plot), data = tree.temp.s.jul)

summary(model.soil.jul.ba.all$gam)
AIC(model.soil.jul.ba.all$mer)

gam.check(model.soil.jul.ba.all$gam)

# canopy openness

plot(model.soil.jul.co.all$gam, scheme = 2, lwd = 3, main = "Average soil temp offset warmest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select =1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# basal area

plot(model.soil.jul.ba.all$gam, scheme = 2, lwd = 3, main = "Average soil temp offset warmest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select =1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)


# Save output

output6 <- rbind(GAMM_r2aic(model.soil.jul.co.all),
                 GAMM_r2aic(model.soil.jul.ba.all))

output6$month <- "Warmest month" #add month
output6$location <- "Soil" #add temp origin
output6$resp.var <- "mean temp" #add response variable
```

The relationship between forest density and proportion of broadleaves seems pretty linear. In fact, when using unidimensional separate smoothers, AIC only grows by *ca.* 1 point.

## Air ERA5 models:

### Only linear, with and without interaction:

```{r}
tree.temp.a.jul$autocorr <- as.integer(paste(day(tree.temp.a.jul$Date), year(tree.temp.a.jul$Date), sep = "")) # temporal autocorrelation correction factor
tree.temp.a.jan$autocorr <- as.integer(paste(day(tree.temp.a.jan$Date), year(tree.temp.a.jan$Date), sep = "")) # temporal autocorrelation correction factor

# Canopy openness as a proxy for forest density

model.air.jul.co.lininteract <- gamm4(air_meanoff_ERA5 ~ CanOpen*perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.air.jul.co.lininteract$gam)
AIC(model.air.jul.co.lininteract$mer)

model.air.jul.co.linadd <- gamm4(air_meanoff_ERA5 ~ CanOpen + perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.air.jul.co.linadd$gam)
AIC(model.air.jul.co.linadd$mer)

model.air.jan.co.lininteract <- gamm4(air_meanoff_ERA5 ~ CanOpen*perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.air.jan.co.lininteract$gam)
AIC(model.air.jan.co.lininteract$mer)

model.air.jan.co.linadd <- gamm4(air_meanoff_ERA5 ~ CanOpen + perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.air.jan.co.linadd$gam)
AIC(model.air.jan.co.linadd$mer)


# Basal area as a proxy for forest density

model.air.jul.ba.lininteract <- gamm4(air_meanoff_ERA5 ~ Basal_Area_20m*perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.air.jul.ba.lininteract$gam)
AIC(model.air.jul.ba.lininteract$mer)

model.air.jul.ba.linadd <- gamm4(air_meanoff_ERA5 ~ Basal_Area_20m + perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.air.jul.ba.linadd$gam)
AIC(model.air.jul.ba.linadd$mer)

model.air.jan.ba.lininteract <- gamm4(air_meanoff_ERA5 ~ Basal_Area_20m*perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.air.jan.ba.lininteract$gam)
AIC(model.air.jan.ba.lininteract$mer)

model.air.jan.ba.linadd <- gamm4(air_meanoff_ERA5 ~ Basal_Area_20m + perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.air.jan.ba.linadd$gam)
AIC(model.air.jan.ba.linadd$mer)
```

Save the model's R squared adjusted and AIC:

```{r}
output7 <- rbind(GAMM_r2aic(model.air.jan.ba.lininteract),
                 GAMM_r2aic(model.air.jan.ba.linadd),
                 GAMM_r2aic(model.air.jan.co.lininteract),
                 GAMM_r2aic(model.air.jan.co.linadd))

output7$month <- "Coldest month" #add month
output7$location <- "Air" #add temp origin
output7$resp.var <- "mean temp" #add response variable

output8 <- rbind(GAMM_r2aic(model.air.jul.ba.lininteract),
                 GAMM_r2aic(model.air.jul.ba.linadd),
                 GAMM_r2aic(model.air.jul.co.lininteract),
                 GAMM_r2aic(model.air.jul.co.linadd))

output8$month <- "Warmest month" #add month
output8$location <- "Air" #add temp origin
output8$resp.var <- "mean temp" #add response variable
```

### Different smoother configurations

```{r}
tree.temp.a.jan$site <- as.factor(tree.temp.a.jan$site)
tree.temp.a.jul$site <- as.factor(tree.temp.a.jul$site)

# Warmest month + canopy openness:
airmodel1 <- gamm4(air_meanoff_ERA5 ~ s(CanOpen,perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel1$gam)
AIC(airmodel1$mer)

airmodel2 <- gamm4(air_meanoff_ERA5 ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel2$gam)
AIC(airmodel2$mer)

airmodel3 <- gamm4(air_meanoff_ERA5 ~ s(CanOpen) + s(perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel3$gam)
AIC(airmodel3$mer)

airmodel4 <- gamm4(air_meanoff_ERA5 ~ s(CanOpen) + s(perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel4$gam)
AIC(airmodel4$mer)

airmodel5 <- gamm4(air_meanoff_ERA5 ~ s(CanOpen, perc_broad_20m, by = site) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel5$gam)
AIC(airmodel5$mer)

airmodel6 <- gamm4(air_meanoff_ERA5 ~ s(CanOpen, perc_broad_20m, by = site) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel6$gam)
AIC(airmodel6$mer)

# Warmest month + basal area:
airmodel7 <- gamm4(air_meanoff_ERA5 ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel7$gam)
AIC(airmodel7$mer)

airmodel8 <- gamm4(air_meanoff_ERA5 ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel8$gam)
AIC(airmodel8$mer)

airmodel9 <- gamm4(air_meanoff_ERA5 ~ s(Basal_Area_20m) + s(perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel9$gam)
AIC(airmodel9$mer)

airmodel10 <- gamm4(air_meanoff_ERA5 ~ s(Basal_Area_20m) + s(perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel10$gam)
AIC(airmodel10$mer)

airmodel11 <- gamm4(air_meanoff_ERA5 ~ s(Basal_Area_20m, perc_broad_20m, by = site) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel11$gam)
AIC(airmodel11$mer)

airmodel12 <- gamm4(air_meanoff_ERA5 ~ s(Basal_Area_20m, perc_broad_20m, by = site) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel12$gam)
AIC(airmodel12$mer)

# Save models
output9 <- rbind(GAMM_r2aic(airmodel1),
                 GAMM_r2aic(airmodel2),
                 GAMM_r2aic(airmodel3),
                 GAMM_r2aic(airmodel4),
                 GAMM_r2aic(airmodel5),
                 GAMM_r2aic(airmodel6),
                 GAMM_r2aic(airmodel7),
                 GAMM_r2aic(airmodel8),
                 GAMM_r2aic(airmodel9),
                 GAMM_r2aic(airmodel10),
                 GAMM_r2aic(airmodel11),
                 GAMM_r2aic(airmodel12))

output9$month <- "Warmest month" #add month
output9$location <- "Air" #add temp origin
output9$resp.var <- "mean temp" #add response variable

# Coldest month + canopy openness:
airmodel13 <- gamm4(air_meanoff_ERA5 ~ s(CanOpen,perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel13$gam)
AIC(airmodel13$mer)

airmodel14 <- gamm4(air_meanoff_ERA5 ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel14$gam)
AIC(airmodel14$mer)

airmodel15 <- gamm4(air_meanoff_ERA5 ~ s(CanOpen) + s(perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel15$gam)
AIC(airmodel15$mer)

airmodel16 <- gamm4(air_meanoff_ERA5 ~ s(CanOpen) + s(perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel16$gam)
AIC(airmodel16$mer)

airmodel17 <- gamm4(air_meanoff_ERA5 ~ s(CanOpen, perc_broad_20m, by = site) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel17$gam)
AIC(airmodel17$mer)

airmodel18 <- gamm4(air_meanoff_ERA5 ~ s(CanOpen, perc_broad_20m, by = site) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel18$gam)
AIC(airmodel18$mer)

# Coldest month + basal area:
airmodel19 <- gamm4(air_meanoff_ERA5 ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel19$gam)
AIC(airmodel19$mer)

airmodel20 <- gamm4(air_meanoff_ERA5 ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel20$gam)
AIC(airmodel20$mer)

airmodel21 <- gamm4(air_meanoff_ERA5 ~ s(Basal_Area_20m) + s(perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel21$gam)
AIC(airmodel21$mer)

airmodel22 <- gamm4(air_meanoff_ERA5 ~ s(Basal_Area_20m) + s(perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel22$gam)
AIC(airmodel22$mer)

airmodel23 <- gamm4(air_meanoff_ERA5 ~ s(Basal_Area_20m, perc_broad_20m, by = site) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel23$gam)
AIC(airmodel23$mer)

airmodel24 <- gamm4(air_meanoff_ERA5 ~ s(Basal_Area_20m, perc_broad_20m, by = site) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel24$gam)
AIC(airmodel24$mer)

# Save models
output10 <- rbind(GAMM_r2aic(airmodel13),
                 GAMM_r2aic(airmodel14),
                 GAMM_r2aic(airmodel15),
                 GAMM_r2aic(airmodel16),
                 GAMM_r2aic(airmodel17),
                 GAMM_r2aic(airmodel18),
                 GAMM_r2aic(airmodel19),
                 GAMM_r2aic(airmodel20),
                 GAMM_r2aic(airmodel21),
                 GAMM_r2aic(airmodel22),
                 GAMM_r2aic(airmodel23),
                 GAMM_r2aic(airmodel24))

output10$month <- "Coldest month" #add month
output10$location <- "Air" #add temp origin
output10$resp.var <- "mean temp" # add response variable
```

### Adding covariates:

For this, we will add all covariates but snow and then remove them according to their p-value.

First we should check for correlation between our covariates:

```{r}
# air temp in January

cor.a.jan <- cor(tree.temp.a.jan[,which(colnames(tree.temp.a.jan) %in% c("era5_wind", "era5_snow", "era5_prev_av_temp", "era5_prev_av_prec", "CanOpen", "perc_broad_20m", "Basal_Area_20m"))], use = "na.or.complete", method = "spearman")

corrplot(cor.a.jan, method = 'ellipse', order = 'AOE', type = 'upper', addCoef.col ='black', number.cex = 0.5)

# air temp in July - removing snow covariate

cor.a.jul <- cor(tree.temp.a.jul[,which(colnames(tree.temp.a.jul) %in% c("era5_wind", "era5_prev_av_temp", "era5_prev_av_prec", "CanOpen", "perc_broad_20m", "Basal_Area_20m"))], method = "spearman")

corrplot(cor.a.jul, method = 'ellipse', order = 'AOE', type = 'upper', addCoef.col ='black', number.cex = 0.5)

```

Nothing to worry about.

#### Coldest month

##### Minimum temperature offset:

```{r}
# basal area
model.minair.jan.ba.all <- gamm4(air_minoff_ERA5 ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site + era5_wind + era5_prev_av_temp + era5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.minair.jan.ba.all$gam)
AIC(model.minair.jan.ba.all$mer)

gam.check(model.minair.jan.ba.all$gam)

# canopy openness
model.minair.jan.co.all <- gamm4(air_minoff_ERA5 ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site + era5_wind + era5_prev_av_temp + era5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.minair.jan.co.all$gam)
AIC(model.minair.jan.co.all$mer)

gam.check(model.minair.jan.co.all$gam)

# Plot: basal area

plot(model.minair.jan.ba.all$gam, scheme = 2, lwd = 3, main = "A) Min air temp offset coldest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Plot: canopy openness

plot(model.minair.jan.co.all$gam, scheme = 2, lwd = 3, main = "B) Min air temp offset coldest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)


# Save output
output11 <- rbind(GAMM_r2aic(model.minair.jan.co.all),
                 GAMM_r2aic(model.minair.jan.ba.all))

output11$month <- "Coldest month" #add month
output11$location <- "Air" #add temp origin
output11$resp.var <- "min temp" #add response variable
```

##### Mean temperature offset:

```{r}
# basal area
model.meanair.jan.ba.all <- gamm4(air_meanoff_ERA5 ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site + era5_wind + era5_prev_av_temp + era5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.meanair.jan.ba.all$gam)
AIC(model.meanair.jan.ba.all$mer)

gam.check(model.meanair.jan.ba.all$gam)

# canopy openness
model.meanair.jan.co.all <- gamm4(air_meanoff_ERA5 ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site + era5_wind + era5_prev_av_temp + era5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.meanair.jan.co.all$gam)
AIC(model.meanair.jan.co.all$mer)

gam.check(model.meanair.jan.co.all$gam)

# Plot: basal area

plot(model.meanair.jan.ba.all$gam, scheme = 2, lwd = 3, main = "A) Mean air temp offset coldest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Plot: Canopy openness

plot(model.meanair.jan.co.all$gam, scheme = 2, lwd = 3, main = "B) Mean air temp offset coldest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)


# Save output
output12 <- rbind(GAMM_r2aic(model.meanair.jan.co.all),
                 GAMM_r2aic(model.meanair.jan.ba.all))

output12$month <- "Coldest month" #add month
output12$location <- "Air" #add temp origin
output12$resp.var <- "mean temp" #add response variable
```

##### Max temperature offset:

```{r}
# basal area
model.maxair.jan.ba.all <- gamm4(air_maxoff_ERA5 ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site + era5_wind + era5_prev_av_temp + era5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.maxair.jan.ba.all$gam)
AIC(model.maxair.jan.ba.all$mer)

gam.check(model.maxair.jan.ba.all$gam)

# canopy openness
model.maxair.jan.co.all <- gamm4(air_maxoff_ERA5 ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site + era5_wind + era5_prev_av_temp + era5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.maxair.jan.co.all$gam)
AIC(model.maxair.jan.co.all$mer)

gam.check(model.maxair.jan.co.all$gam)

# Plot: Basal area

plot(model.maxair.jan.ba.all$gam, scheme = 2, lwd = 3, main = "Max air temp offset coldest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Plot: Canopy openness

plot(model.maxair.jan.co.all$gam, scheme = 2, lwd = 3, main = "Max air temp offset coldest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Save output
output13 <- rbind(GAMM_r2aic(model.maxair.jan.co.all),
                 GAMM_r2aic(model.maxair.jan.ba.all))

output13$month <- "Coldest month" #add month
output13$location <- "Air" #add temp origin
output13$resp.var <- "max temp" #add response variable
```

#### Warmest month

##### Minimum temperature offset:

```{r}
# basal area
model.minair.jul.ba.all <- gamm4(air_minoff_ERA5 ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site + era5_wind + era5_prev_av_temp + era5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.minair.jul.ba.all$gam)
AIC(model.minair.jul.ba.all$mer)

gam.check(model.minair.jul.ba.all$gam)

# canopy openness
model.minair.jul.co.all <- gamm4(air_minoff_ERA5 ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site + era5_wind + era5_prev_av_temp + era5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.minair.jul.co.all$gam)
AIC(model.minair.jul.co.all$mer)

gam.check(model.minair.jul.co.all$gam)

#Plot: Basal area

plot(model.minair.jul.ba.all$gam, scheme = 2, lwd = 3, main = "Min air temp offset warmest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Plot: Canopy openness

plot(model.minair.jul.co.all$gam, scheme = 2, lwd = 3, main = "Min air temp offset warmest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Save output
output14 <- rbind(GAMM_r2aic(model.minair.jul.co.all),
                 GAMM_r2aic(model.minair.jul.ba.all))

output14$month <- "Warmest month" #add month
output14$location <- "Air" #add temp origin
output14$resp.var <- "min temp" #add response variable
```

##### Mean temperature offset

```{r}
# basal area
model.meanair.jul.ba.all <- gamm4(air_meanoff_ERA5 ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site + era5_wind + era5_prev_av_temp + era5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.meanair.jul.ba.all$gam)
AIC(model.meanair.jul.ba.all$mer)

gam.check(model.meanair.jul.ba.all$gam)

# canopy openness
model.meanair.jul.co.all <- gamm4(air_meanoff_ERA5 ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site + era5_wind + era5_prev_av_temp + era5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.meanair.jul.co.all$gam)
AIC(model.meanair.jul.co.all$mer)
gam.check(model.meanair.jul.co.all$gam)

# Plot: Basal area

plot(model.meanair.jul.ba.all$gam, scheme = 2, lwd = 3, main = "Mean air temp offset warmest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Plot: Canopy openness

plot(model.meanair.jul.co.all$gam, scheme = 2, lwd = 3, main = "Mean air temp offset warmest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Save output
output15 <- rbind(GAMM_r2aic(model.meanair.jul.co.all),
                 GAMM_r2aic(model.meanair.jul.ba.all))

output15$month <- "Warmest month" #add month
output15$location <- "Air" #add temp origin
output15$resp.var <- "mean temp" #add response variable
```

##### Maximum temperature offset

```{r}
# basal area
model.maxair.jul.ba.all <- gamm4(air_maxoff_ERA5 ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site + era5_wind + era5_prev_av_temp + era5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.maxair.jul.ba.all$gam)
AIC(model.maxair.jul.ba.all$mer)
gam.check(model.maxair.jul.ba.all$gam)

# canopy openness
model.maxair.jul.co.all <- gamm4(air_maxoff_ERA5 ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site + era5_wind + era5_prev_av_temp + era5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.maxair.jul.co.all$gam)
AIC(model.maxair.jul.co.all$mer)

gam.check(model.maxair.jul.co.all$gam)

# Plot: Basal area

plot(model.maxair.jul.ba.all$gam, scheme = 2, lwd = 3, main = "Max air temp offset warmest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

# Plot: Canopy Openness

plot(model.maxair.jul.co.all$gam, scheme = 2, lwd = 3, main = "Max air temp offset warmest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Save output
output16 <- rbind(GAMM_r2aic(model.maxair.jul.co.all),
                 GAMM_r2aic(model.maxair.jul.ba.all))

output16$month <- "Warmest month" #add month
output16$location <- "Air" #add temp origin
output16$resp.var <- "max temp" #add response variable
```

## Put together all the plots:

### ERA5 Soil

```{r}
# Canopy openness
par(mfrow=c(3,2), mar=c(5.1,4.5,4.2,2.5))

plot(model.soil.jan.co.all$gam, scheme = 2, lwd = 3, main = "A) Mean soil temp offset coldest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select =1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)

plot(model.soil.jul.co.all$gam, scheme = 2, lwd = 3, main = "B) Mean soil temp offset warmest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select =1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)


# Basal area

plot(model.soil.jan.ba.all$gam, scheme = 2, lwd = 3, main = "C) Mean soil temp offset coldest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.axis = 2, cex.main = 2.5, too.far = 0.2, rug=T, hcolor=colfunc(999), select =1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)

plot(model.soil.jul.ba.all$gam, scheme = 2, lwd = 3, main = "D) Mean soil temp offset warmest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)
```

### ERA5 Air

```{r}
# Basal area

par(mfrow=c(3,2), mar = c(5.3,4.5,4.3,2.5))

plot(model.minair.jan.ba.all$gam, scheme = 2, lwd = 3, main = "A) Min air temp ERA5 offset coldest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.minair.jul.ba.all$gam, scheme = 2, lwd = 3, main = "B) Min air temp ERA5 offset warmest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.meanair.jan.ba.all$gam, scheme = 2, lwd = 3, main = "C) Mean air temp ERA5 offset coldest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.meanair.jul.ba.all$gam, scheme = 2, lwd = 3, main = "D) Mean air temp ERA5 offset warmest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.maxair.jan.ba.all$gam, scheme = 2, lwd = 3, main = "E) Max air temp ERA5 offset coldest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.maxair.jul.ba.all$gam, scheme = 2, lwd = 3, main = "F) Max air temp ERA5 offset warmest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Canopy openness

par(mfrow=c(3,2), mar = c(5.3,4.5,4.3,2.5))

plot(model.minair.jan.co.all$gam, scheme = 2, lwd = 3, main = "A) Min air temp ERA5 offset coldest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.minair.jul.co.all$gam, scheme = 2, lwd = 3, main = "B) Min air temp ERA5 offset warmest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.meanair.jan.co.all$gam, scheme = 2, lwd = 3, main = "C) Mean air temp ERA5 offset coldest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.meanair.jul.co.all$gam, scheme = 2, lwd = 3, main = "D) Mean air temp ERA5 offset warmest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.maxair.jan.co.all$gam, scheme = 2, lwd = 3, main = "E) Max air temp ERA5 offset coldest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)

plot(model.maxair.jul.co.all$gam, scheme = 2, lwd = 3, main = "F) Max air temp ERA5 offset warmest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)

```

### Save ERA5 output table:

```{r}
era5.results <- rbind(output1, output2, output3, output4, output5, output6, output7, output8, output9, output10, output11, output12, output13, output14, output15, output16)

# cleanup models:
rm(list = ls(pattern = "model"))
rm(list = ls(pattern = "output"))
```

# Models with 'mcera5' offsets

There are no soil models, as no macroclimatic soil data could be downloaded through the 'mcera5' R package.

## Air 'mcera5' loggers:

### Only linear, with and without interaction:

```{r}
# Canopy openness as a proxy for forest density

model.air.jul.co.lininteract <- gamm4(air_meanoff_mcera5 ~ CanOpen*perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.air.jul.co.lininteract$gam)
AIC(model.air.jul.co.lininteract$mer)

model.air.jul.co.linadd <- gamm4(air_meanoff_mcera5 ~ CanOpen + perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.air.jul.co.linadd$gam)
AIC(model.air.jul.co.linadd$mer)

model.air.jan.co.lininteract <- gamm4(air_meanoff_mcera5 ~ CanOpen*perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.air.jan.co.lininteract$gam)
AIC(model.air.jan.co.lininteract$mer)

model.air.jan.co.linadd <- gamm4(air_meanoff_mcera5 ~ CanOpen + perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.air.jan.co.linadd$gam)
AIC(model.air.jan.co.linadd$mer)


# Basal area as a proxy for forest density

model.air.jul.ba.lininteract <- gamm4(air_meanoff_mcera5 ~ Basal_Area_20m*perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.air.jul.ba.lininteract$gam)
AIC(model.air.jul.ba.lininteract$mer)

model.air.jul.ba.linadd <- gamm4(air_meanoff_mcera5 ~ Basal_Area_20m + perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.air.jul.ba.linadd$gam)
AIC(model.air.jul.ba.linadd$mer)

model.air.jan.ba.lininteract <- gamm4(air_meanoff_mcera5 ~ Basal_Area_20m*perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.air.jan.ba.lininteract$gam)
AIC(model.air.jan.ba.lininteract$mer)

model.air.jan.ba.linadd <- gamm4(air_meanoff_mcera5 ~ Basal_Area_20m + perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.air.jan.ba.linadd$gam)
AIC(model.air.jan.ba.linadd$mer)
```

Save the model's R squared adjusted and AIC:

```{r}
output1 <- rbind(GAMM_r2aic(model.air.jan.ba.lininteract),
                 GAMM_r2aic(model.air.jan.ba.linadd),
                 GAMM_r2aic(model.air.jan.co.lininteract),
                 GAMM_r2aic(model.air.jan.co.linadd))

output1$month <- "Coldest month" #add month
output1$location <- "Air" #add temp origin
output1$resp.var <- "mean temp" #add response variable

output2 <- rbind(GAMM_r2aic(model.air.jul.ba.lininteract),
                 GAMM_r2aic(model.air.jul.ba.linadd),
                 GAMM_r2aic(model.air.jul.co.lininteract),
                 GAMM_r2aic(model.air.jul.co.linadd))

output2$month <- "Warmest month" #add month
output2$location <- "Air" #add temp origin
output2$resp.var <- "mean temp" #add response variable
```

### Different smoother configurations

```{r}
tree.temp.a.jul$site <- as.factor(tree.temp.a.jul$site)
tree.temp.a.jan$site <- as.factor(tree.temp.a.jan$site)

# Warmest month + canopy openness:
airmodel1 <- gamm4(air_meanoff_mcera5 ~ s(CanOpen,perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel1$gam)
AIC(airmodel1$mer)

airmodel2 <- gamm4(air_meanoff_mcera5 ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel2$gam)
AIC(airmodel2$mer)

airmodel3 <- gamm4(air_meanoff_mcera5 ~ s(CanOpen) + s(perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel3$gam)
AIC(airmodel3$mer)

airmodel4 <- gamm4(air_meanoff_mcera5 ~ s(CanOpen) + s(perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel4$gam)
AIC(airmodel4$mer)

airmodel5 <- gamm4(air_meanoff_mcera5 ~ s(CanOpen, perc_broad_20m, by = site) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel5$gam)
AIC(airmodel5$mer)

airmodel6 <- gamm4(air_meanoff_mcera5 ~ s(CanOpen, perc_broad_20m, by = site) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel6$gam)
AIC(airmodel6$mer)

# Warmest month + basal area:
airmodel7 <- gamm4(air_meanoff_mcera5 ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel7$gam)
AIC(airmodel7$mer)

airmodel8 <- gamm4(air_meanoff_mcera5 ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel8$gam)
AIC(airmodel8$mer)

airmodel9 <- gamm4(air_meanoff_mcera5 ~ s(Basal_Area_20m) + s(perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel9$gam)
AIC(airmodel9$mer)

airmodel10 <- gamm4(air_meanoff_mcera5 ~ s(Basal_Area_20m) + s(perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel10$gam)
AIC(airmodel10$mer)

airmodel11 <- gamm4(air_meanoff_mcera5 ~ s(Basal_Area_20m, perc_broad_20m, by = site) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel11$gam)
AIC(airmodel11$mer)

airmodel12 <- gamm4(air_meanoff_mcera5 ~ s(Basal_Area_20m, perc_broad_20m, by = site) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel12$gam)
AIC(airmodel12$mer)

# Save models
output3 <- rbind(GAMM_r2aic(airmodel1),
                 GAMM_r2aic(airmodel2),
                 GAMM_r2aic(airmodel3),
                 GAMM_r2aic(airmodel4),
                 GAMM_r2aic(airmodel5),
                 GAMM_r2aic(airmodel6),
                 GAMM_r2aic(airmodel7),
                 GAMM_r2aic(airmodel8),
                 GAMM_r2aic(airmodel9),
                 GAMM_r2aic(airmodel10),
                 GAMM_r2aic(airmodel11),
                 GAMM_r2aic(airmodel12))

output3$month <- "Warmest month" #add month
output3$location <- "Air" #add temp origin
output3$resp.var <- "mean temp" #add response variable

# Coldest month + canopy openness:
airmodel13 <- gamm4(air_meanoff_mcera5 ~ s(CanOpen,perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel13$gam)
AIC(airmodel13$mer)

airmodel14 <- gamm4(air_meanoff_mcera5 ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel14$gam)
AIC(airmodel14$mer)

airmodel15 <- gamm4(air_meanoff_mcera5 ~ s(CanOpen) + s(perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel15$gam)
AIC(airmodel15$mer)

airmodel16 <- gamm4(air_meanoff_mcera5 ~ s(CanOpen) + s(perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel16$gam)
AIC(airmodel16$mer)

airmodel17 <- gamm4(air_meanoff_mcera5 ~ s(CanOpen, perc_broad_20m, by = site) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel17$gam)
AIC(airmodel17$mer)

airmodel18 <- gamm4(air_meanoff_mcera5 ~ s(CanOpen, perc_broad_20m, by = site) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel18$gam)
AIC(airmodel18$mer)

# Coldest month + basal area:
airmodel19 <- gamm4(air_meanoff_mcera5 ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel19$gam)
AIC(airmodel19$mer)

airmodel20 <- gamm4(air_meanoff_mcera5 ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel20$gam)
AIC(airmodel20$mer)

airmodel21 <- gamm4(air_meanoff_mcera5 ~ s(Basal_Area_20m) + s(perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel21$gam)
AIC(airmodel21$mer)

airmodel22 <- gamm4(air_meanoff_mcera5 ~ s(Basal_Area_20m) + s(perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel22$gam)
AIC(airmodel22$mer)

airmodel23 <- gamm4(air_meanoff_mcera5 ~ s(Basal_Area_20m, perc_broad_20m, by = site) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel23$gam)
AIC(airmodel23$mer)

airmodel24 <- gamm4(air_meanoff_mcera5 ~ s(Basal_Area_20m, perc_broad_20m, by = site) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel24$gam)
AIC(airmodel24$mer)

# Save models
output4 <- rbind(GAMM_r2aic(airmodel13),
                 GAMM_r2aic(airmodel14),
                 GAMM_r2aic(airmodel15),
                 GAMM_r2aic(airmodel16),
                 GAMM_r2aic(airmodel17),
                 GAMM_r2aic(airmodel18),
                 GAMM_r2aic(airmodel19),
                 GAMM_r2aic(airmodel20),
                 GAMM_r2aic(airmodel21),
                 GAMM_r2aic(airmodel22),
                 GAMM_r2aic(airmodel23),
                 GAMM_r2aic(airmodel24))

output4$month <- "Coldest month" #add month
output4$location <- "Air" #add temp origin
output4$resp.var <- "mean temp" # add response variable
```

### Adding covariates:

For this, we will add all covariates but snow and then remove them according to their p-value.

First we should check for correlation between our covariates:

```{r}
# air temp in January

cor.a.jan <- cor(tree.temp.a.jan[,which(colnames(tree.temp.a.jan) %in% c("era5_wind", "era5_snow", "mcera5_prev_av_temp", "mcera5_prev_av_prec", "CanOpen", "perc_broad_20m", "Basal_Area_20m"))], use = "na.or.complete", method = "spearman")

corrplot(cor.a.jan, method = 'ellipse', order = 'AOE', type = 'upper', addCoef.col ='black', number.cex = 0.5)

# air temp in July - removing snow covariate

cor.a.jul <- cor(tree.temp.a.jul[,which(colnames(tree.temp.a.jul) %in% c("era5_wind", "mcera5_prev_av_temp", "mcera5_prev_av_prec", "CanOpen", "perc_broad_20m", "Basal_Area_20m"))], method = "spearman")

corrplot(cor.a.jul, method = 'ellipse', order = 'AOE', type = 'upper', addCoef.col ='black', number.cex = 0.5)

```

Nothing to worry about.

#### Coldest month

##### Minimum temperature offset:

```{r}
# basal area
model.minair.jan.ba.all <- gamm4(air_minoff_mcera5 ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site + era5_wind + mcera5_prev_av_temp + mcera5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.minair.jan.ba.all$gam)
AIC(model.minair.jan.ba.all$mer)

gam.check(model.minair.jan.ba.all$gam)

# canopy openness
model.minair.jan.co.all <- gamm4(air_minoff_mcera5 ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site + era5_wind + mcera5_prev_av_temp + mcera5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.minair.jan.co.all$gam)
AIC(model.minair.jan.co.all$mer)

gam.check(model.minair.jan.co.all$gam)

# Plot: basal area

plot(model.minair.jan.ba.all$gam, scheme = 2, lwd = 3, main = "Min air temp offset coldest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Plot: canopy openness

plot(model.minair.jan.co.all$gam, scheme = 2, lwd = 3, main = "Min air temp offset coldest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)


# Save output
output5 <- rbind(GAMM_r2aic(model.minair.jan.co.all),
                 GAMM_r2aic(model.minair.jan.ba.all))

output5$month <- "Coldest month" #add month
output5$location <- "Air" #add temp origin
output5$resp.var <- "min temp" #add response variable
```

##### Mean temperature offset:

```{r}
# basal area
model.meanair.jan.ba.all <- gamm4(air_meanoff_mcera5 ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site + era5_wind + mcera5_prev_av_temp + mcera5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.meanair.jan.ba.all$gam)
AIC(model.meanair.jan.ba.all$mer)

gam.check(model.meanair.jan.ba.all$gam)

# canopy openness
model.meanair.jan.co.all <- gamm4(air_meanoff_mcera5 ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site + era5_wind + mcera5_prev_av_temp + mcera5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.meanair.jan.co.all$gam)
AIC(model.meanair.jan.co.all$mer)

gam.check(model.meanair.jan.co.all$gam)

# Plot: basal area

plot(model.meanair.jan.ba.all$gam, scheme = 2, lwd = 3, main = "Mean air temp offset coldest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Plot: Canopy openness

plot(model.meanair.jan.co.all$gam, scheme = 2, lwd = 3, main = "Mean air temp offset coldest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)


# Save output
output6 <- rbind(GAMM_r2aic(model.meanair.jan.co.all),
                 GAMM_r2aic(model.meanair.jan.ba.all))

output6$month <- "Coldest month" #add month
output6$location <- "Air" #add temp origin
output6$resp.var <- "mean temp" #add response variable
```

##### Max temperature offset:

```{r}
# basal area
model.maxair.jan.ba.all <- gamm4(air_maxoff_mcera5 ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site + era5_wind + mcera5_prev_av_temp + mcera5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.maxair.jan.ba.all$gam)
AIC(model.maxair.jan.ba.all$mer)

gam.check(model.maxair.jan.ba.all$gam)

# canopy openness
model.maxair.jan.co.all <- gamm4(air_maxoff_mcera5 ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site + era5_wind + mcera5_prev_av_temp + mcera5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.maxair.jan.co.all$gam)
AIC(model.maxair.jan.co.all$mer)

gam.check(model.maxair.jan.co.all$gam)

# Plot: Basal area

plot(model.maxair.jan.ba.all$gam, scheme = 2, lwd = 3, main = "Max air temp offset coldest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Plot: Canopy openness

plot(model.maxair.jan.co.all$gam, scheme = 2, lwd = 3, main = "Max air temp offset coldest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Save output
output7 <- rbind(GAMM_r2aic(model.maxair.jan.co.all),
                 GAMM_r2aic(model.maxair.jan.ba.all))

output7$month <- "Coldest month" #add month
output7$location <- "Air" #add temp origin
output7$resp.var <- "max temp" #add response variable
```

#### Warmest month

##### Minimum temperature offset:

```{r}
# basal area
model.minair.jul.ba.all <- gamm4(air_minoff_mcera5 ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site + era5_wind + mcera5_prev_av_temp + mcera5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.minair.jul.ba.all$gam)
AIC(model.minair.jul.ba.all$mer)

gam.check(model.minair.jul.ba.all$gam)

# canopy openness
model.minair.jul.co.all <- gamm4(air_minoff_mcera5 ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site + era5_wind + mcera5_prev_av_temp + mcera5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.minair.jul.co.all$gam)
AIC(model.minair.jul.co.all$mer)

gam.check(model.minair.jul.co.all$gam)

#Plot: Basal area

plot(model.minair.jul.ba.all$gam, scheme = 2, lwd = 3, main = "Min air temp offset warmest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Plot: Canopy openness

plot(model.minair.jul.co.all$gam, scheme = 2, lwd = 3, main = "Min air temp offset warmest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Save output
output8 <- rbind(GAMM_r2aic(model.minair.jul.co.all),
                 GAMM_r2aic(model.minair.jul.ba.all))

output8$month <- "Warmest month" #add month
output8$location <- "Air" #add temp origin
output8$resp.var <- "min temp" #add response variable
```

##### Mean temperature offset

```{r}
# basal area
model.meanair.jul.ba.all <- gamm4(air_meanoff_mcera5 ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site + era5_wind + mcera5_prev_av_temp + mcera5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.meanair.jul.ba.all$gam)
AIC(model.meanair.jul.ba.all$mer)

gam.check(model.meanair.jul.ba.all$gam)

# canopy openness
model.meanair.jul.co.all <- gamm4(air_meanoff_mcera5 ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site + era5_wind + mcera5_prev_av_temp + mcera5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.meanair.jul.co.all$gam)
AIC(model.meanair.jul.co.all$mer)
gam.check(model.meanair.jul.co.all$gam)

# Plot: Basal area

plot(model.meanair.jul.ba.all$gam, scheme = 2, lwd = 3, main = "Mean air temp offset warmest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Plot: Canopy openness

plot(model.meanair.jul.co.all$gam, scheme = 2, lwd = 3, main = "Mean air temp offset warmest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Save output
output9 <- rbind(GAMM_r2aic(model.meanair.jul.co.all),
                 GAMM_r2aic(model.meanair.jul.ba.all))

output9$month <- "Warmest month" #add month
output9$location <- "Air" #add temp origin
output9$resp.var <- "mean temp" #add response variable
```

##### Maximum temperature offset

```{r}
# basal area
model.maxair.jul.ba.all <- gamm4(air_maxoff_mcera5 ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site + era5_wind + mcera5_prev_av_temp + mcera5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.maxair.jul.ba.all$gam)
AIC(model.maxair.jul.ba.all$mer)
gam.check(model.maxair.jul.ba.all$gam)

# canopy openness
model.maxair.jul.co.all <- gamm4(air_maxoff_mcera5 ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site + era5_wind + mcera5_prev_av_temp + mcera5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.maxair.jul.co.all$gam)
AIC(model.maxair.jul.co.all$mer)

gam.check(model.maxair.jul.co.all$gam)

# Plot: Basal area

plot(model.maxair.jul.ba.all$gam, scheme = 2, lwd = 3, main = "Max air temp offset warmest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

# Plot: Canopy Openness

plot(model.maxair.jul.co.all$gam, scheme = 2, lwd = 3, main = "Max air temp offset warmest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Save output
output10 <- rbind(GAMM_r2aic(model.maxair.jul.co.all),
                 GAMM_r2aic(model.maxair.jul.ba.all))

output10$month <- "Warmest month" #add month
output10$location <- "Air" #add temp origin
output10$resp.var <- "max temp" #add response variable
```

## Put together all the plots:

```{r}
# Basal area

par(mfrow=c(3,2), mar = c(5.3,4.5,4.3,2.5))

plot(model.minair.jan.ba.all$gam, scheme = 2, lwd = 3, main = "A) Min air temp mcera5 offset coldest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.minair.jul.ba.all$gam, scheme = 2, lwd = 3, main = "B) Min air temp mcera5 offset warmest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.meanair.jan.ba.all$gam, scheme = 2, lwd = 3, main = "C) Mean air temp mcera5 offset coldest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.meanair.jul.ba.all$gam, scheme = 2, lwd = 3, main = "D) Mean air temp mcera5 offset warmest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.maxair.jan.ba.all$gam, scheme = 2, lwd = 3, main = "E) Max air temp mcera5 offset coldest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.maxair.jul.ba.all$gam, scheme = 2, lwd = 3, main = "F) Max air temp mcera5 offset warmest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Canopy openness

par(mfrow=c(3,2), mar = c(5.3,4.5,4.3,2.5))

plot(model.minair.jan.co.all$gam, scheme = 2, lwd = 3, main = "A) Min air temp mcera5 offset coldest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.minair.jul.co.all$gam, scheme = 2, lwd = 3, main = "B) Min air temp mcera5 offset warmest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.meanair.jan.co.all$gam, scheme = 2, lwd = 3, main = "C) Mean air temp mcera5 offset coldest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.meanair.jul.co.all$gam, scheme = 2, lwd = 3, main = "D) Mean air temp mcera5 offset warmest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.maxair.jan.co.all$gam, scheme = 2, lwd = 3, main = "E) Max air temp mcera5 offset coldest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)

plot(model.maxair.jul.co.all$gam, scheme = 2, lwd = 3, main = "F) Max air temp mcera5 offset warmest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)
```

### Save 'mcera5' output table:

```{r}
mcera5.results <- rbind(output1, output2, output3, output4, output5, output6, output7, output8, output9, output10)

# cleanup models:
rm(list = ls(pattern = "model"))
rm(list = ls(pattern = "output"))
```

# Models with weather station offsets

## Air WS models

### Only linear, with and without interaction:

```{r}
# Canopy openness as a proxy for forest density

model.air.jul.co.lininteract <- gamm4(air_meanoff_ws ~ CanOpen*perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.air.jul.co.lininteract$gam)
AIC(model.air.jul.co.lininteract$mer)

model.air.jul.co.linadd <- gamm4(air_meanoff_ws ~ CanOpen + perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.air.jul.co.linadd$gam)
AIC(model.air.jul.co.linadd$mer)

model.air.jan.co.lininteract <- gamm4(air_meanoff_ws ~ CanOpen*perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.air.jan.co.lininteract$gam)
AIC(model.air.jan.co.lininteract$mer)

model.air.jan.co.linadd <- gamm4(air_meanoff_ws ~ CanOpen + perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.air.jan.co.linadd$gam)
AIC(model.air.jan.co.linadd$mer)


# Basal area as a proxy for forest density

model.air.jul.ba.lininteract <- gamm4(air_meanoff_ws ~ Basal_Area_20m*perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.air.jul.ba.lininteract$gam)
AIC(model.air.jul.ba.lininteract$mer)

model.air.jul.ba.linadd <- gamm4(air_meanoff_ws ~ Basal_Area_20m + perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.air.jul.ba.linadd$gam)
AIC(model.air.jul.ba.linadd$mer)

model.air.jan.ba.lininteract <- gamm4(air_meanoff_ws ~ Basal_Area_20m*perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.air.jan.ba.lininteract$gam)
AIC(model.air.jan.ba.lininteract$mer)

model.air.jan.ba.linadd <- gamm4(air_meanoff_ws ~ Basal_Area_20m + perc_broad_20m + site + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.air.jan.ba.linadd$gam)
AIC(model.air.jan.ba.linadd$mer)
```

Save the model's R squared adjusted and AIC:

```{r}
output1 <- rbind(GAMM_r2aic(model.air.jan.ba.lininteract),
                 GAMM_r2aic(model.air.jan.ba.linadd),
                 GAMM_r2aic(model.air.jan.co.lininteract),
                 GAMM_r2aic(model.air.jan.co.linadd))

output1$month <- "Coldest month" #add month
output1$location <- "Air" #add temp origin
output1$resp.var <- "mean temp" #add response variable

output2 <- rbind(GAMM_r2aic(model.air.jul.ba.lininteract),
                 GAMM_r2aic(model.air.jul.ba.linadd),
                 GAMM_r2aic(model.air.jul.co.lininteract),
                 GAMM_r2aic(model.air.jul.co.linadd))

output2$month <- "Warmest month" #add month
output2$location <- "Air" #add temp origin
output2$resp.var <- "mean temp" #add response variable
```

### Different smoother configurations

```{r}
tree.temp.a.jul$site <- as.factor(tree.temp.a.jul$site)
tree.temp.a.jan$site <- as.factor(tree.temp.a.jan$site)

# Warmest month + canopy openness:
airmodel1 <- gamm4(air_meanoff_ws ~ s(CanOpen,perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel1$gam)
AIC(airmodel1$mer)

airmodel2 <- gamm4(air_meanoff_ws ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel2$gam)
AIC(airmodel2$mer)

airmodel3 <- gamm4(air_meanoff_ws ~ s(CanOpen) + s(perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel3$gam)
AIC(airmodel3$mer)

airmodel4 <- gamm4(air_meanoff_ws ~ s(CanOpen) + s(perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel4$gam)
AIC(airmodel4$mer)

airmodel5 <- gamm4(air_meanoff_ws ~ s(CanOpen, perc_broad_20m, by = site) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel5$gam)
AIC(airmodel5$mer)

airmodel6 <- gamm4(air_meanoff_ws ~ s(CanOpen, perc_broad_20m, by = site) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel6$gam)
AIC(airmodel6$mer)

# Warmest month + basal area:
airmodel7 <- gamm4(air_meanoff_ws ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel7$gam)
AIC(airmodel7$mer)

airmodel8 <- gamm4(air_meanoff_ws ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel8$gam)
AIC(airmodel8$mer)

airmodel9 <- gamm4(air_meanoff_ws ~ s(Basal_Area_20m) + s(perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel9$gam)
AIC(airmodel9$mer)

airmodel10 <- gamm4(air_meanoff_ws ~ s(Basal_Area_20m) + s(perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel10$gam)
AIC(airmodel10$mer)

airmodel11 <- gamm4(air_meanoff_ws ~ s(Basal_Area_20m, perc_broad_20m, by = site) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel11$gam)
AIC(airmodel11$mer)

airmodel12 <- gamm4(air_meanoff_ws ~ s(Basal_Area_20m, perc_broad_20m, by = site) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(airmodel12$gam)
AIC(airmodel12$mer)

# Save models
output3 <- rbind(GAMM_r2aic(airmodel1),
                 GAMM_r2aic(airmodel2),
                 GAMM_r2aic(airmodel3),
                 GAMM_r2aic(airmodel4),
                 GAMM_r2aic(airmodel5),
                 GAMM_r2aic(airmodel6),
                 GAMM_r2aic(airmodel7),
                 GAMM_r2aic(airmodel8),
                 GAMM_r2aic(airmodel9),
                 GAMM_r2aic(airmodel10),
                 GAMM_r2aic(airmodel11),
                 GAMM_r2aic(airmodel12))

output3$month <- "Warmest month" #add month
output3$location <- "Air" #add temp origin
output3$resp.var <- "mean temp" #add response variable

# Coldest month + canopy openness:
airmodel13 <- gamm4(air_meanoff_ws ~ s(CanOpen,perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel13$gam)
AIC(airmodel13$mer)

airmodel14 <- gamm4(air_meanoff_ws ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel14$gam)
AIC(airmodel14$mer)

airmodel15 <- gamm4(air_meanoff_ws ~ s(CanOpen) + s(perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel15$gam)
AIC(airmodel15$mer)

airmodel16 <- gamm4(air_meanoff_ws ~ s(CanOpen) + s(perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel16$gam)
AIC(airmodel16$mer)

airmodel17 <- gamm4(air_meanoff_ws ~ s(CanOpen, perc_broad_20m, by = site) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel17$gam)
AIC(airmodel17$mer)

airmodel18 <- gamm4(air_meanoff_ws ~ s(CanOpen, perc_broad_20m, by = site) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel18$gam)
AIC(airmodel18$mer)

# Coldest month + basal area:
airmodel19 <- gamm4(air_meanoff_ws ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel19$gam)
AIC(airmodel19$mer)

airmodel20 <- gamm4(air_meanoff_ws ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel20$gam)
AIC(airmodel20$mer)

airmodel21 <- gamm4(air_meanoff_ws ~ s(Basal_Area_20m) + s(perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel21$gam)
AIC(airmodel21$mer)

airmodel22 <- gamm4(air_meanoff_ws ~ s(Basal_Area_20m) + s(perc_broad_20m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel22$gam)
AIC(airmodel22$mer)

airmodel23 <- gamm4(air_meanoff_ws ~ s(Basal_Area_20m, perc_broad_20m, by = site) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel23$gam)
AIC(airmodel23$mer)

airmodel24 <- gamm4(air_meanoff_ws ~ s(Basal_Area_20m, perc_broad_20m, by = site) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(airmodel24$gam)
AIC(airmodel24$mer)

# Save models
output4 <- rbind(GAMM_r2aic(airmodel13),
                 GAMM_r2aic(airmodel14),
                 GAMM_r2aic(airmodel15),
                 GAMM_r2aic(airmodel16),
                 GAMM_r2aic(airmodel17),
                 GAMM_r2aic(airmodel18),
                 GAMM_r2aic(airmodel19),
                 GAMM_r2aic(airmodel20),
                 GAMM_r2aic(airmodel21),
                 GAMM_r2aic(airmodel22),
                 GAMM_r2aic(airmodel23),
                 GAMM_r2aic(airmodel24))

output4$month <- "Coldest month" #add month
output4$location <- "Air" #add temp origin
output4$resp.var <- "mean temp" # add response variable
```

### Adding covariates:

For this, we will add all covariates but snow and then remove them according to their p-value.

First we should check for correlation between our covariates:

```{r}
# air temp in January

cor.a.jan <- cor(tree.temp.a.jan[,which(colnames(tree.temp.a.jan) %in% c("era5_wind", "era5_snow", "mcera5_prev_av_temp", "mcera5_prev_av_prec", "CanOpen", "perc_broad_20m", "Basal_Area_20m"))], use = "na.or.complete", method = "spearman")

corrplot(cor.a.jan, method = 'ellipse', order = 'AOE', type = 'upper', addCoef.col ='black', number.cex = 0.5)

# air temp in July - removing snow covariate

cor.a.jul <- cor(tree.temp.a.jul[,which(colnames(tree.temp.a.jul) %in% c("era5_wind", "mcera5_prev_av_temp", "mcera5_prev_av_prec", "CanOpen", "perc_broad_20m", "Basal_Area_20m"))], method = "spearman")

corrplot(cor.a.jul, method = 'ellipse', order = 'AOE', type = 'upper', addCoef.col ='black', number.cex = 0.5)

```

Nothing to worry about.

#### Coldest month

##### Minimum temperature offset:

```{r}
# basal area
model.minair.jan.ba.all <- gamm4(air_minoff_ws ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site + era5_wind + ws_prev_av_temp + mcera5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.minair.jan.ba.all$gam)
AIC(model.minair.jan.ba.all$mer)

gam.check(model.minair.jan.ba.all$gam)

# canopy openness
model.minair.jan.co.all <- gamm4(air_minoff_ws ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site + era5_wind + ws_prev_av_temp + mcera5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.minair.jan.co.all$gam)
AIC(model.minair.jan.co.all$mer)

gam.check(model.minair.jan.co.all$gam)

# Plot: basal area

plot(model.minair.jan.ba.all$gam, scheme = 2, lwd = 3, main = "Min air temp offset coldest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Plot: canopy openness

plot(model.minair.jan.co.all$gam, scheme = 2, lwd = 3, main = "Min air temp offset coldest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)


# Save output
output5 <- rbind(GAMM_r2aic(model.minair.jan.co.all),
                 GAMM_r2aic(model.minair.jan.ba.all))

output5$month <- "Coldest month" #add month
output5$location <- "Air" #add temp origin
output5$resp.var <- "min temp" #add response variable
```

##### Mean temperature offset:

```{r}
# basal area
model.meanair.jan.ba.all <- gamm4(air_meanoff_ws ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site + era5_wind + ws_prev_av_temp + mcera5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.meanair.jan.ba.all$gam)
AIC(model.meanair.jan.ba.all$mer)

gam.check(model.meanair.jan.ba.all$gam)

# canopy openness
model.meanair.jan.co.all <- gamm4(air_meanoff_ws ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site + era5_wind + ws_prev_av_temp + mcera5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.meanair.jan.co.all$gam)
AIC(model.meanair.jan.co.all$mer)

gam.check(model.meanair.jan.co.all$gam)

# Plot: basal area

plot(model.meanair.jan.ba.all$gam, scheme = 2, lwd = 3, main = "Mean air temp offset coldest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Plot: Canopy openness

plot(model.meanair.jan.co.all$gam, scheme = 2, lwd = 3, main = "Mean air temp offset coldest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)


# Save output
output6 <- rbind(GAMM_r2aic(model.meanair.jan.co.all),
                 GAMM_r2aic(model.meanair.jan.ba.all))

output6$month <- "Coldest month" #add month
output6$location <- "Air" #add temp origin
output6$resp.var <- "mean temp" #add response variable
```

##### Max temperature offset:

```{r}
# basal area
model.maxair.jan.ba.all <- gamm4(air_maxoff_ws ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site + era5_wind + ws_prev_av_temp + mcera5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.maxair.jan.ba.all$gam)
AIC(model.maxair.jan.ba.all$mer)

gam.check(model.maxair.jan.ba.all$gam)

# canopy openness
model.maxair.jan.co.all <- gamm4(air_maxoff_ws ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site + era5_wind + ws_prev_av_temp + mcera5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jan)

summary(model.maxair.jan.co.all$gam)
AIC(model.maxair.jan.co.all$mer)

gam.check(model.maxair.jan.co.all$gam)

# Plot: Basal area

plot(model.maxair.jan.ba.all$gam, scheme = 2, lwd = 3, main = "Max air temp offset coldest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Plot: Canopy openness

plot(model.maxair.jan.co.all$gam, scheme = 2, lwd = 3, main = "Max air temp offset coldest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Save output
output7 <- rbind(GAMM_r2aic(model.maxair.jan.co.all),
                 GAMM_r2aic(model.maxair.jan.ba.all))

output7$month <- "Coldest month" #add month
output7$location <- "Air" #add temp origin
output7$resp.var <- "max temp" #add response variable
```

#### Warmest month

##### Minimum temperature offset:

```{r}
# basal area
model.minair.jul.ba.all <- gamm4(air_minoff_ws ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site + era5_wind + ws_prev_av_temp + mcera5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.minair.jul.ba.all$gam)
AIC(model.minair.jul.ba.all$mer)

gam.check(model.minair.jul.ba.all$gam)

# canopy openness
model.minair.jul.co.all <- gamm4(air_minoff_ws ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site + era5_wind + ws_prev_av_temp + mcera5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.minair.jul.co.all$gam)
AIC(model.minair.jul.co.all$mer)

gam.check(model.minair.jul.co.all$gam)

#Plot: Basal area

plot(model.minair.jul.ba.all$gam, scheme = 2, lwd = 3, main = "Min air temp offset warmest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Plot: Canopy openness

plot(model.minair.jul.co.all$gam, scheme = 2, lwd = 3, main = "Min air temp offset warmest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Save output
output8 <- rbind(GAMM_r2aic(model.minair.jul.co.all),
                 GAMM_r2aic(model.minair.jul.ba.all))

output8$month <- "Warmest month" #add month
output8$location <- "Air" #add temp origin
output8$resp.var <- "min temp" #add response variable
```

##### Mean temperature offset

```{r}
# basal area
model.meanair.jul.ba.all <- gamm4(air_meanoff_ws ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site + era5_wind + ws_prev_av_temp + mcera5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.meanair.jul.ba.all$gam)
AIC(model.meanair.jul.ba.all$mer)

gam.check(model.meanair.jul.ba.all$gam)

# canopy openness
model.meanair.jul.co.all <- gamm4(air_meanoff_ws ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site + era5_wind + ws_prev_av_temp + mcera5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.meanair.jul.co.all$gam)
AIC(model.meanair.jul.co.all$mer)
gam.check(model.meanair.jul.co.all$gam)

# Plot: Basal area

plot(model.meanair.jul.ba.all$gam, scheme = 2, lwd = 3, main = "Mean air temp offset warmest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Plot: Canopy openness

plot(model.meanair.jul.co.all$gam, scheme = 2, lwd = 3, main = "Mean air temp offset warmest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Save output
output9 <- rbind(GAMM_r2aic(model.meanair.jul.co.all),
                 GAMM_r2aic(model.meanair.jul.ba.all))

output9$month <- "Warmest month" #add month
output9$location <- "Air" #add temp origin
output9$resp.var <- "mean temp" #add response variable
```

##### Maximum temperature offset

```{r}
# basal area
model.maxair.jul.ba.all <- gamm4(air_maxoff_ws ~ s(Basal_Area_20m,perc_broad_20m) + s(autocorr) + site + era5_wind + ws_prev_av_temp + mcera5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.maxair.jul.ba.all$gam)
AIC(model.maxair.jul.ba.all$mer)
gam.check(model.maxair.jul.ba.all$gam)

# canopy openness
model.maxair.jul.co.all <- gamm4(air_maxoff_ws ~ s(CanOpen,perc_broad_20m) + s(autocorr) + site + era5_wind + ws_prev_av_temp + mcera5_prev_av_prec, random = ~ (1|site:Plot), data = tree.temp.a.jul)

summary(model.maxair.jul.co.all$gam)
AIC(model.maxair.jul.co.all$mer)

gam.check(model.maxair.jul.co.all$gam)

# Plot: Basal area

plot(model.maxair.jul.ba.all$gam, scheme = 2, lwd = 3, main = "Max air temp offset warmest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

# Plot: Canopy Openness

plot(model.maxair.jul.co.all$gam, scheme = 2, lwd = 3, main = "Max air temp offset warmest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 1.5, labcex = 1.1, cex.main = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Save output
output10 <- rbind(GAMM_r2aic(model.maxair.jul.co.all),
                 GAMM_r2aic(model.maxair.jul.ba.all))

output10$month <- "Warmest month" #add month
output10$location <- "Air" #add temp origin
output10$resp.var <- "max temp" #add response variable
```

## Put together all the plots:

```{r}
# Basal area

par(mfrow=c(3,2), mar = c(5.3,4.5,4.3,2.5))

plot(model.minair.jan.ba.all$gam, scheme = 2, lwd = 3, main = "A) Min air temp offset coldest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.minair.jul.ba.all$gam, scheme = 2, lwd = 3, main = "B) Min air temp offset warmest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.meanair.jan.ba.all$gam, scheme = 2, lwd = 3, main = "C) Mean air temp offset coldest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.meanair.jul.ba.all$gam, scheme = 2, lwd = 3, main = "D) Mean air temp offset warmest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.maxair.jan.ba.all$gam, scheme = 2, lwd = 3, main = "E) Max air temp offset coldest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.maxair.jul.ba.all$gam, scheme = 2, lwd = 3, main = "F) Max air temp offset warmest month", xlab = expression(paste("Basal Area (", m^2, " \U00B7 ", ha^-1,")")), ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$Basal_Area_20m, tree.temp$perc_broad_20m, pch = 4, cex = 1)

# Canopy openness

par(mfrow=c(3,2), mar = c(5.3,4.5,4.3,2.5))

plot(model.minair.jan.co.all$gam, scheme = 2, lwd = 3, main = "A) Min air temp offset coldest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.minair.jul.co.all$gam, scheme = 2, lwd = 3, main = "B) Min air temp offset warmest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.meanair.jan.co.all$gam, scheme = 2, lwd = 3, main = "C) Mean air temp offset coldest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.meanair.jul.co.all$gam, scheme = 2, lwd = 3, main = "D) Mean air temp offset warmest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)


plot(model.maxair.jan.co.all$gam, scheme = 2, lwd = 3, main = "E) Max air temp offset coldest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)

plot(model.maxair.jul.co.all$gam, scheme = 2, lwd = 3, main = "F) Max air temp offset warmest month", xlab = "Canopy openness", ylab = "Proportion of broadleaves (%)", cex.lab = 2, labcex = 1.5, cex.main = 2.5, cex.axis = 2, too.far = 0.2, rug=T, hcolor=colfunc(999), select = 1)

points(tree.temp$CanOpen, tree.temp$perc_broad_20m, pch = 4, cex = 1)
```

### Save WS output table:

```{r}
ws.results <- rbind(output1, output2, output3, output4, output5, output6, output7, output8, output9, output10)

# cleanup models:
rm(list = ls(pattern = "model"))
rm(list = ls(pattern = "output"))

era5.results$source <- "ERA5"
mcera5.results$source <- "mcera5"
ws.results$source <- "Weather station"

all.results <- rbind(era5.results, mcera5.results, ws.results)
```

Before exporting these data... We have one row per model, i.e. the same model when run with Canopy Openness and Basal area takes two rows. We'll merge those models.

```{r}
#Separate BA and CO models:

results.co <- all.results[which(all.results$forest.density == "Canopy openness"),]

results.ba <- all.results[which(all.results$forest.density == "Basal Area"),]

#Select variables
results.co <- results.co[,which(colnames(results.co) %in% c("formula", "rsq", "aic", "location", "source", "month"))]

results.ba <- results.ba[,-which(colnames(results.ba) == "forest.density")]

#rename Rsquared and AIC from each dataset

results.co <- results.co %>% dplyr::rename(
  rsq_co = rsq,
  aic_co = aic)

results.ba <- results.ba %>% dplyr::rename(
  rsq_ba = rsq,
  aic_ba = aic)

# standardize formulas for merging
results.ba$formula <- gsub("Basal_Area_20m", "Forest_density", results.ba$formula)

results.co$formula <- gsub("CanOpen", "Forest_density", results.co$formula)

#merge

results.baco <- results.ba %>% right_join(results.co, by=c("formula", "location", "source", "month"))

write.csv2(results.baco, file = "./DATASETS/Table_S2.csv", row.names = FALSE)
```

To predict temperature offsets based on our models, use the **predict.gam()** function, specifying the model (air or soil temperature offset, and minumum, mean or maximum temperature, as well as example data with forest density data ["CanOpen" for canopy openness or "Basal_Area_20m" for basal area], percentage of broadleaves "perc_broad_20m", wind "era5_wind", averaged temperature in the last 5 days "ws_prev_av_temp", averaged precipitation in the last 5 days "mcera5_prev_av_prec", snow ["era5_snow", when needed] and site ["site"] and an autocorrelation parameter based on date ["autocorr"]).

For example, here we will predict mean and maximum air temperature offsets for our site in northern Sweden at basal area of 25 m2*ha-1 and percentage of broadleaves of 0, 25 and 100:
_For the values in wind, previous precipitation and previous temperature we have used the average of all data available during the warmest month in northern Sweden (Sandsj)._

```{r}
# Load example data in the correct format:

example <- read.csv("./DATASETS/example.csv", header = TRUE, sep = ";")

example

# Predictions of mean air temperature offsets:
predict.gam(model.meanair.jul.ba.all$gam, newdata = example, se.fit = TRUE)

# Predictions of maximum air temperature offsets:
predict.gam(model.maxair.jul.ba.all$gam, newdata = example, se.fit = TRUE)
```

# Distance analyses:

Now we want to assess the effect of forest density assessed at different radii. We measured all trees at a maximum of 10 m from each logger (with the exception of Arville, in which this distance was 20 m - but we will remove this site as the forest was somewhat different in composition and structure to the rest of the study sites). BA has been calculated based on trees measured at different distances, from 4 to 10 m [see script 4]. Here we will run the final models obtained above for all these radii. Only ERA5 data will be used.

## All sites but Belgium

Remove Arville (no soil loggers in Arville, so we will only remove this site from the air logger datasets). We will also save a dataset only with Arville for later.

```{r}
tree.temp.a.jul <- tree.temp.a.jul[-which(tree.temp.a.jul$site == "Arville"),]

tree.temp.a.jan <- tree.temp.a.jan[-which(tree.temp.a.jan$site == "Arville"),]

tree.temp.a.jul.arville <- tree.temp.a.jul[which(tree.temp.a.jul$site == "Arville"),]

tree.temp.a.jan.arville <- tree.temp.a.jan[which(tree.temp.a.jan$site == "Arville"),]
```

### Soil models:

#### Warmest month:

```{r}
# only Forest density

soil10_0 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil09_0 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil08_0 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil07_0 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil06_0 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil05_0 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil04_0 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

# only broadleaves

soil0_10 <- gamm4(soil_meanoff_ERA5~s(perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil0_09 <- gamm4(soil_meanoff_ERA5~s(perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil0_08 <- gamm4(soil_meanoff_ERA5~s(perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil0_07 <- gamm4(soil_meanoff_ERA5~s(perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil0_06 <- gamm4(soil_meanoff_ERA5~s(perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil0_05 <- gamm4(soil_meanoff_ERA5~s(perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil0_04 <- gamm4(soil_meanoff_ERA5~s(perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

# all combinations

soil10_10 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_10m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil10_09 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_10m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil10_08 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_10m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil10_07 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_10m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil10_06 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_10m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil10_05 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_10m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil10_04 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_10m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil09_10 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_09m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil09_09 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_09m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil09_08 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_09m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil09_07 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_09m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil09_06 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_09m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil09_05 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_09m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil09_04 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_09m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil08_10 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_08m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil08_09 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_08m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil08_08 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_08m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil08_07 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_08m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil08_06 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_08m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil08_05 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_08m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil08_04 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_08m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil07_10 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_07m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil07_09 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_07m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil07_08 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_07m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil07_07 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_07m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil07_06 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_07m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil07_05 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_07m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil07_04 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_07m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil06_10 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_06m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil06_09 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_06m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil06_08 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_06m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil06_07 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_06m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil06_06 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_06m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil06_05 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_06m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil06_04 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_06m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil05_10 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_05m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil05_09 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_05m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil05_08 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_05m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil05_07 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_05m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil05_06 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_05m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil05_05 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_05m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil05_04 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_05m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil04_10 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_04m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil04_09 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_04m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil04_08 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_04m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil04_07 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_04m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil04_06 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_04m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil04_05 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_04m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)

soil04_04 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_04m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jul)


# Save models
output2 <- rbind(GAMM_r2aic(soil10_0),
                 GAMM_r2aic(soil09_0),
                 GAMM_r2aic(soil08_0),
                 GAMM_r2aic(soil07_0),
                 GAMM_r2aic(soil06_0),
                 GAMM_r2aic(soil05_0),
                 GAMM_r2aic(soil04_0),
                 GAMM_r2aic(soil0_10),
                 GAMM_r2aic(soil0_09),
                 GAMM_r2aic(soil0_08),
                 GAMM_r2aic(soil0_07),
                 GAMM_r2aic(soil0_06),
                 GAMM_r2aic(soil0_05),
                 GAMM_r2aic(soil0_04),
                 GAMM_r2aic(soil10_10),
                 GAMM_r2aic(soil10_09),
                 GAMM_r2aic(soil10_08),
                 GAMM_r2aic(soil10_07),
                 GAMM_r2aic(soil10_06),
                 GAMM_r2aic(soil10_05),
                 GAMM_r2aic(soil10_04),
                 GAMM_r2aic(soil09_10),
                 GAMM_r2aic(soil09_09),
                 GAMM_r2aic(soil09_08),
                 GAMM_r2aic(soil09_07),
                 GAMM_r2aic(soil09_06),
                 GAMM_r2aic(soil09_05),
                 GAMM_r2aic(soil09_04),
                 GAMM_r2aic(soil08_10),
                 GAMM_r2aic(soil08_09),
                 GAMM_r2aic(soil08_08),
                 GAMM_r2aic(soil08_07),
                 GAMM_r2aic(soil08_06),
                 GAMM_r2aic(soil08_05),
                 GAMM_r2aic(soil08_04),
                 GAMM_r2aic(soil07_10),
                 GAMM_r2aic(soil07_09),
                 GAMM_r2aic(soil07_08),
                 GAMM_r2aic(soil07_07),
                 GAMM_r2aic(soil07_06),
                 GAMM_r2aic(soil07_05),
                 GAMM_r2aic(soil07_04),
                 GAMM_r2aic(soil06_10),
                 GAMM_r2aic(soil06_09),
                 GAMM_r2aic(soil06_08),
                 GAMM_r2aic(soil06_07),
                 GAMM_r2aic(soil06_06),
                 GAMM_r2aic(soil06_05),
                 GAMM_r2aic(soil06_04),
                 GAMM_r2aic(soil05_10),
                 GAMM_r2aic(soil05_09),
                 GAMM_r2aic(soil05_08),
                 GAMM_r2aic(soil05_07),
                 GAMM_r2aic(soil05_06),
                 GAMM_r2aic(soil05_05),
                 GAMM_r2aic(soil05_04),
                 GAMM_r2aic(soil04_10),
                 GAMM_r2aic(soil04_09),
                 GAMM_r2aic(soil04_08),
                 GAMM_r2aic(soil04_07),
                 GAMM_r2aic(soil04_06),
                 GAMM_r2aic(soil04_05),
                 GAMM_r2aic(soil04_04))

output2$month <- "Warmest month" #add month
output2$location <- "Soil" #add temp origin
output2$resp.var <- "mean temp" # add response variable

# cleanup models:
rm(list = ls(pattern = "soil"))
```

#### Coldest month:

```{r}
# only Forest density

soil10_0 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil09_0 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil08_0 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil07_0 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil06_0 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil05_0 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil04_0 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

# only broadleaves

soil0_10 <- gamm4(soil_meanoff_ERA5~s(perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil0_09 <- gamm4(soil_meanoff_ERA5~s(perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil0_08 <- gamm4(soil_meanoff_ERA5~s(perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil0_07 <- gamm4(soil_meanoff_ERA5~s(perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil0_06 <- gamm4(soil_meanoff_ERA5~s(perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil0_05 <- gamm4(soil_meanoff_ERA5~s(perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil0_04 <- gamm4(soil_meanoff_ERA5~s(perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

# all combinations

soil10_10 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_10m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil10_09 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_10m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil10_08 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_10m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil10_07 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_10m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil10_06 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_10m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil10_05 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_10m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil10_04 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_10m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil09_10 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_09m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil09_09 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_09m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil09_08 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_09m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil09_07 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_09m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil09_06 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_09m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil09_05 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_09m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil09_04 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_09m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil08_10 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_08m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil08_09 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_08m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil08_08 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_08m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil08_07 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_08m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil08_06 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_08m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil08_05 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_08m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil08_04 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_08m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil07_10 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_07m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil07_09 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_07m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil07_08 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_07m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil07_07 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_07m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil07_06 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_07m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil07_05 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_07m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil07_04 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_07m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil06_10 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_06m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil06_09 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_06m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil06_08 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_06m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil06_07 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_06m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil06_06 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_06m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil06_05 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_06m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil06_04 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_06m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil05_10 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_05m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil05_09 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_05m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil05_08 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_05m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil05_07 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_05m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil05_06 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_05m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil05_05 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_05m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil05_04 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_05m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil04_10 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_04m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil04_09 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_04m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil04_08 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_04m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil04_07 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_04m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil04_06 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_04m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil04_05 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_04m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)

soil04_04 <- gamm4(soil_meanoff_ERA5~s(Basal_Area_04m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.s.jan)


# Save models
output1 <- rbind(GAMM_r2aic(soil10_0),
                 GAMM_r2aic(soil09_0),
                 GAMM_r2aic(soil08_0),
                 GAMM_r2aic(soil07_0),
                 GAMM_r2aic(soil06_0),
                 GAMM_r2aic(soil05_0),
                 GAMM_r2aic(soil04_0),
                 GAMM_r2aic(soil0_10),
                 GAMM_r2aic(soil0_09),
                 GAMM_r2aic(soil0_08),
                 GAMM_r2aic(soil0_07),
                 GAMM_r2aic(soil0_06),
                 GAMM_r2aic(soil0_05),
                 GAMM_r2aic(soil0_04),
                 GAMM_r2aic(soil10_10),
                 GAMM_r2aic(soil10_09),
                 GAMM_r2aic(soil10_08),
                 GAMM_r2aic(soil10_07),
                 GAMM_r2aic(soil10_06),
                 GAMM_r2aic(soil10_05),
                 GAMM_r2aic(soil10_04),
                 GAMM_r2aic(soil09_10),
                 GAMM_r2aic(soil09_09),
                 GAMM_r2aic(soil09_08),
                 GAMM_r2aic(soil09_07),
                 GAMM_r2aic(soil09_06),
                 GAMM_r2aic(soil09_05),
                 GAMM_r2aic(soil09_04),
                 GAMM_r2aic(soil08_10),
                 GAMM_r2aic(soil08_09),
                 GAMM_r2aic(soil08_08),
                 GAMM_r2aic(soil08_07),
                 GAMM_r2aic(soil08_06),
                 GAMM_r2aic(soil08_05),
                 GAMM_r2aic(soil08_04),
                 GAMM_r2aic(soil07_10),
                 GAMM_r2aic(soil07_09),
                 GAMM_r2aic(soil07_08),
                 GAMM_r2aic(soil07_07),
                 GAMM_r2aic(soil07_06),
                 GAMM_r2aic(soil07_05),
                 GAMM_r2aic(soil07_04),
                 GAMM_r2aic(soil06_10),
                 GAMM_r2aic(soil06_09),
                 GAMM_r2aic(soil06_08),
                 GAMM_r2aic(soil06_07),
                 GAMM_r2aic(soil06_06),
                 GAMM_r2aic(soil06_05),
                 GAMM_r2aic(soil06_04),
                 GAMM_r2aic(soil05_10),
                 GAMM_r2aic(soil05_09),
                 GAMM_r2aic(soil05_08),
                 GAMM_r2aic(soil05_07),
                 GAMM_r2aic(soil05_06),
                 GAMM_r2aic(soil05_05),
                 GAMM_r2aic(soil05_04),
                 GAMM_r2aic(soil04_10),
                 GAMM_r2aic(soil04_09),
                 GAMM_r2aic(soil04_08),
                 GAMM_r2aic(soil04_07),
                 GAMM_r2aic(soil04_06),
                 GAMM_r2aic(soil04_05),
                 GAMM_r2aic(soil04_04))

output1$month <- "Coldest month" #add month
output1$location <- "Soil" #add temp origin
output1$resp.var <- "mean temp" # add response variable

# cleanup models:
rm(list = ls(pattern = "soil"))
```

### Air models:

#### Warmest month:

```{r}
# only Forest density

air10_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air09_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air08_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air07_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air06_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air05_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air04_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

# only broadleaves

air0_10 <- gamm4(air_meanoff_ERA5~s(perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air0_09 <- gamm4(air_meanoff_ERA5~s(perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air0_08 <- gamm4(air_meanoff_ERA5~s(perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air0_07 <- gamm4(air_meanoff_ERA5~s(perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air0_06 <- gamm4(air_meanoff_ERA5~s(perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air0_05 <- gamm4(air_meanoff_ERA5~s(perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air0_04 <- gamm4(air_meanoff_ERA5~s(perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

# all combinations

air10_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air10_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air10_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air10_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air10_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air10_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air10_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air09_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air09_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air09_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air09_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air09_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air09_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air09_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air08_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air08_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air08_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air08_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air08_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air08_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air08_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air07_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air07_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air07_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air07_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air07_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air07_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air07_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air06_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air06_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air06_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air06_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air06_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air06_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air06_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air05_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air05_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air05_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air05_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air05_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air05_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air05_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air04_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air04_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air04_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air04_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air04_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air04_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)

air04_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jul)


# Save models
output3 <- rbind(GAMM_r2aic(air10_0),
                 GAMM_r2aic(air09_0),
                 GAMM_r2aic(air08_0),
                 GAMM_r2aic(air07_0),
                 GAMM_r2aic(air06_0),
                 GAMM_r2aic(air05_0),
                 GAMM_r2aic(air04_0),
                 GAMM_r2aic(air0_10),
                 GAMM_r2aic(air0_09),
                 GAMM_r2aic(air0_08),
                 GAMM_r2aic(air0_07),
                 GAMM_r2aic(air0_06),
                 GAMM_r2aic(air0_05),
                 GAMM_r2aic(air0_04),
                 GAMM_r2aic(air10_10),
                 GAMM_r2aic(air10_09),
                 GAMM_r2aic(air10_08),
                 GAMM_r2aic(air10_07),
                 GAMM_r2aic(air10_06),
                 GAMM_r2aic(air10_05),
                 GAMM_r2aic(air10_04),
                 GAMM_r2aic(air09_10),
                 GAMM_r2aic(air09_09),
                 GAMM_r2aic(air09_08),
                 GAMM_r2aic(air09_07),
                 GAMM_r2aic(air09_06),
                 GAMM_r2aic(air09_05),
                 GAMM_r2aic(air09_04),
                 GAMM_r2aic(air08_10),
                 GAMM_r2aic(air08_09),
                 GAMM_r2aic(air08_08),
                 GAMM_r2aic(air08_07),
                 GAMM_r2aic(air08_06),
                 GAMM_r2aic(air08_05),
                 GAMM_r2aic(air08_04),
                 GAMM_r2aic(air07_10),
                 GAMM_r2aic(air07_09),
                 GAMM_r2aic(air07_08),
                 GAMM_r2aic(air07_07),
                 GAMM_r2aic(air07_06),
                 GAMM_r2aic(air07_05),
                 GAMM_r2aic(air07_04),
                 GAMM_r2aic(air06_10),
                 GAMM_r2aic(air06_09),
                 GAMM_r2aic(air06_08),
                 GAMM_r2aic(air06_07),
                 GAMM_r2aic(air06_06),
                 GAMM_r2aic(air06_05),
                 GAMM_r2aic(air06_04),
                 GAMM_r2aic(air05_10),
                 GAMM_r2aic(air05_09),
                 GAMM_r2aic(air05_08),
                 GAMM_r2aic(air05_07),
                 GAMM_r2aic(air05_06),
                 GAMM_r2aic(air05_05),
                 GAMM_r2aic(air05_04),
                 GAMM_r2aic(air04_10),
                 GAMM_r2aic(air04_09),
                 GAMM_r2aic(air04_08),
                 GAMM_r2aic(air04_07),
                 GAMM_r2aic(air04_06),
                 GAMM_r2aic(air04_05),
                 GAMM_r2aic(air04_04))

output3$month <- "Warmest month" #add month
output3$location <- "air" #add temp origin
output3$resp.var <- "mean temp" # add response variable

# cleanup models:
rm(list = ls(pattern = "air"))
```

#### Coldest month:

```{r}
# only Forest density

air10_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air09_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air08_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air07_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air06_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air05_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air04_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

# only broadleaves

air0_10 <- gamm4(air_meanoff_ERA5~s(perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air0_09 <- gamm4(air_meanoff_ERA5~s(perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air0_08 <- gamm4(air_meanoff_ERA5~s(perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air0_07 <- gamm4(air_meanoff_ERA5~s(perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air0_06 <- gamm4(air_meanoff_ERA5~s(perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air0_05 <- gamm4(air_meanoff_ERA5~s(perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air0_04 <- gamm4(air_meanoff_ERA5~s(perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

# all combinations

air10_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air10_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air10_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air10_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air10_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air10_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air10_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air09_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air09_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air09_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air09_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air09_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air09_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air09_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air08_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air08_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air08_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air08_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air08_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air08_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air08_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air07_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air07_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air07_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air07_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air07_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air07_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air07_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air06_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air06_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air06_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air06_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air06_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air06_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air06_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air05_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air05_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air05_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air05_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air05_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air05_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air05_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air04_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_10m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air04_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_09m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air04_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_08m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air04_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_07m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air04_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_06m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air04_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_05m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)

air04_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_04m) + s(autocorr) + site, random = ~ (1|site:Plot), data = tree.temp.a.jan)


# Save models
output4 <- rbind(GAMM_r2aic(air10_0),
                 GAMM_r2aic(air09_0),
                 GAMM_r2aic(air08_0),
                 GAMM_r2aic(air07_0),
                 GAMM_r2aic(air06_0),
                 GAMM_r2aic(air05_0),
                 GAMM_r2aic(air04_0),
                 GAMM_r2aic(air0_10),
                 GAMM_r2aic(air0_09),
                 GAMM_r2aic(air0_08),
                 GAMM_r2aic(air0_07),
                 GAMM_r2aic(air0_06),
                 GAMM_r2aic(air0_05),
                 GAMM_r2aic(air0_04),
                 GAMM_r2aic(air10_10),
                 GAMM_r2aic(air10_09),
                 GAMM_r2aic(air10_08),
                 GAMM_r2aic(air10_07),
                 GAMM_r2aic(air10_06),
                 GAMM_r2aic(air10_05),
                 GAMM_r2aic(air10_04),
                 GAMM_r2aic(air09_10),
                 GAMM_r2aic(air09_09),
                 GAMM_r2aic(air09_08),
                 GAMM_r2aic(air09_07),
                 GAMM_r2aic(air09_06),
                 GAMM_r2aic(air09_05),
                 GAMM_r2aic(air09_04),
                 GAMM_r2aic(air08_10),
                 GAMM_r2aic(air08_09),
                 GAMM_r2aic(air08_08),
                 GAMM_r2aic(air08_07),
                 GAMM_r2aic(air08_06),
                 GAMM_r2aic(air08_05),
                 GAMM_r2aic(air08_04),
                 GAMM_r2aic(air07_10),
                 GAMM_r2aic(air07_09),
                 GAMM_r2aic(air07_08),
                 GAMM_r2aic(air07_07),
                 GAMM_r2aic(air07_06),
                 GAMM_r2aic(air07_05),
                 GAMM_r2aic(air07_04),
                 GAMM_r2aic(air06_10),
                 GAMM_r2aic(air06_09),
                 GAMM_r2aic(air06_08),
                 GAMM_r2aic(air06_07),
                 GAMM_r2aic(air06_06),
                 GAMM_r2aic(air06_05),
                 GAMM_r2aic(air06_04),
                 GAMM_r2aic(air05_10),
                 GAMM_r2aic(air05_09),
                 GAMM_r2aic(air05_08),
                 GAMM_r2aic(air05_07),
                 GAMM_r2aic(air05_06),
                 GAMM_r2aic(air05_05),
                 GAMM_r2aic(air05_04),
                 GAMM_r2aic(air04_10),
                 GAMM_r2aic(air04_09),
                 GAMM_r2aic(air04_08),
                 GAMM_r2aic(air04_07),
                 GAMM_r2aic(air04_06),
                 GAMM_r2aic(air04_05),
                 GAMM_r2aic(air04_04))

output4$month <- "Coldest month" #add month
output4$location <- "air" #add temp origin
output4$resp.var <- "mean temp" # add response variable

# cleanup models:
rm(list = ls(pattern = "air"))
```

### Save model outputs:

```{r}
radii.results <- rbind(output1, output2, output3, output4)

radii.results$source <- "ERA5"

write.csv2(radii.results, file = "./DATASETS/Table_S3.csv", row.names = FALSE)
```

## Belgium on its own:

Since we measured all trees within a 20 m radius in Arville, we will also run models for radii at each meter between 4 and 20 to see at what scale does the microclimate work.

### Air models:

No soil loggers were installed in Belgium because of wild boar populations.

#### Warmest month:

```{r}
# only Forest density

air20_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air19_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air18_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air17_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air16_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air15_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air14_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air13_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air12_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air11_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air10_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air09_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air08_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air07_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air06_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air05_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air04_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

# only broadleaves

air0_20 <- gamm4(air_meanoff_ERA5~s(perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air0_19 <- gamm4(air_meanoff_ERA5~s(perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air0_18 <- gamm4(air_meanoff_ERA5~s(perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air0_17 <- gamm4(air_meanoff_ERA5~s(perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air0_16 <- gamm4(air_meanoff_ERA5~s(perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air0_15 <- gamm4(air_meanoff_ERA5~s(perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air0_14 <- gamm4(air_meanoff_ERA5~s(perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air0_13 <- gamm4(air_meanoff_ERA5~s(perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air0_12 <- gamm4(air_meanoff_ERA5~s(perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air0_11 <- gamm4(air_meanoff_ERA5~s(perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air0_10 <- gamm4(air_meanoff_ERA5~s(perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air0_09 <- gamm4(air_meanoff_ERA5~s(perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air0_08 <- gamm4(air_meanoff_ERA5~s(perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air0_07 <- gamm4(air_meanoff_ERA5~s(perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air0_06 <- gamm4(air_meanoff_ERA5~s(perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air0_05 <- gamm4(air_meanoff_ERA5~s(perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

# air0_04 <- gamm4(air_meanoff_ERA5~s(perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

# all combinations

air20_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air20_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air20_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air20_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air20_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air20_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air20_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air20_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air20_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air20_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air20_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air20_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air20_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air20_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air20_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air20_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air20_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air19_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air19_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air19_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air19_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air19_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air19_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air19_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air19_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air19_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air19_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air19_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air19_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air19_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air19_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air19_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air19_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air19_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air18_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air18_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air18_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air18_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air18_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air18_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air18_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air18_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air18_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air18_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air18_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air18_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air18_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air18_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air18_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air18_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air18_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air17_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air17_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air17_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air17_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air17_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air17_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air17_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air17_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air17_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air17_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air17_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air17_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air17_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air17_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air17_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air17_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air17_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air16_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air16_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air16_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air16_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air16_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air16_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air16_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air16_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air16_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air16_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air16_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air16_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air16_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air16_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air16_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air16_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air16_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air15_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air15_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air15_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air15_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air15_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air15_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air15_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air15_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air15_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air15_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air15_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air15_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air15_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air15_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air15_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air15_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air15_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air14_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air14_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air14_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air14_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air14_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air14_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air14_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air14_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air14_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air14_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air14_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air14_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air14_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air14_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air14_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air14_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air14_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air13_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air13_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air13_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air13_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air13_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air13_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air13_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air13_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air13_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air13_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air13_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air13_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air13_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air13_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air13_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air13_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air13_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air12_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air12_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air12_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air12_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air12_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air12_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air12_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air12_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air12_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air12_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air12_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air12_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air12_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air12_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air12_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air12_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air12_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air11_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air11_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air11_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air11_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air11_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air11_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air11_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air11_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air11_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air11_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air11_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air11_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air11_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air11_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air11_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air11_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air11_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air10_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air10_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air10_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air10_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air10_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air10_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air10_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air10_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air10_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air10_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air10_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air10_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air10_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air10_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air10_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air10_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air10_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air09_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air09_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air09_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air09_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air09_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air09_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air09_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air09_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air09_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air09_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air09_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air09_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air09_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air09_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air09_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air09_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air09_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air08_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air08_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air08_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air08_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air08_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air08_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air08_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air08_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air08_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air08_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air08_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air08_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air08_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air08_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air08_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air08_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air08_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air07_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air07_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air07_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air07_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air07_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air07_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air07_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air07_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air07_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air07_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air07_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air07_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air07_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air07_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air07_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air07_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air07_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air06_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air06_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air06_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air06_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air06_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air06_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air06_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air06_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air06_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air06_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air06_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air06_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air06_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air06_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air06_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air06_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air06_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air05_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air05_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air05_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air05_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air05_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air05_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air05_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air05_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air05_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air05_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air05_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air05_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air05_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air05_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air05_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

#air05_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

#air05_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air04_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air04_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air04_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air04_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air04_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air04_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air04_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

air04_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

#air04_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

#air04_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

#air04_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

#air04_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

#air04_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

#air04_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

#air04_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

#air04_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)

#air04_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jul.arville)


# Save models
output1 <- rbind(GAMM_r2aic(air20_0),
                 GAMM_r2aic(air19_0),
                 GAMM_r2aic(air18_0),
                 GAMM_r2aic(air17_0),
                 GAMM_r2aic(air16_0),
                 GAMM_r2aic(air15_0),
                 GAMM_r2aic(air14_0),
                 GAMM_r2aic(air13_0),
                 GAMM_r2aic(air12_0),
                 GAMM_r2aic(air11_0),
                 GAMM_r2aic(air10_0),
                 GAMM_r2aic(air09_0),
                 GAMM_r2aic(air08_0),
                 GAMM_r2aic(air07_0),
                 GAMM_r2aic(air06_0),
                 GAMM_r2aic(air05_0),
                 GAMM_r2aic(air04_0),
                 GAMM_r2aic(air0_20),
                 GAMM_r2aic(air0_19),
                 GAMM_r2aic(air0_18),
                 GAMM_r2aic(air0_17),
                 GAMM_r2aic(air0_16),
                 GAMM_r2aic(air0_15),
                 GAMM_r2aic(air0_14),
                 GAMM_r2aic(air0_13),
                 GAMM_r2aic(air0_12),
                 GAMM_r2aic(air0_11),
                 GAMM_r2aic(air0_10),
                 GAMM_r2aic(air0_09),
                 GAMM_r2aic(air0_08),
                 GAMM_r2aic(air0_07),
                 GAMM_r2aic(air0_06),
                 GAMM_r2aic(air0_05),
                 GAMM_r2aic(air20_20),
                 GAMM_r2aic(air20_19),
                 GAMM_r2aic(air20_18),
                 GAMM_r2aic(air20_17),
                 GAMM_r2aic(air20_16),
                 GAMM_r2aic(air20_15),
                 GAMM_r2aic(air20_14),
                 GAMM_r2aic(air20_13),
                 GAMM_r2aic(air20_12),
                 GAMM_r2aic(air20_11),
                 GAMM_r2aic(air20_10),
                 GAMM_r2aic(air20_09),
                 GAMM_r2aic(air20_08),
                 GAMM_r2aic(air20_07),
                 GAMM_r2aic(air20_06),
                 GAMM_r2aic(air20_05),
                 GAMM_r2aic(air20_04),
                 GAMM_r2aic(air19_20),
                 GAMM_r2aic(air19_19),
                 GAMM_r2aic(air19_18),
                 GAMM_r2aic(air19_17),
                 GAMM_r2aic(air19_16),
                 GAMM_r2aic(air19_15),
                 GAMM_r2aic(air19_14),
                 GAMM_r2aic(air19_13),
                 GAMM_r2aic(air19_12),
                 GAMM_r2aic(air19_11),
                 GAMM_r2aic(air19_10),
                 GAMM_r2aic(air19_09),
                 GAMM_r2aic(air19_08),
                 GAMM_r2aic(air19_07),
                 GAMM_r2aic(air19_06),
                 GAMM_r2aic(air19_05),
                 GAMM_r2aic(air19_04),
                 GAMM_r2aic(air18_20),
                 GAMM_r2aic(air18_19),
                 GAMM_r2aic(air18_18),
                 GAMM_r2aic(air18_17),
                 GAMM_r2aic(air18_16),
                 GAMM_r2aic(air18_15),
                 GAMM_r2aic(air18_14),
                 GAMM_r2aic(air18_13),
                 GAMM_r2aic(air18_12),
                 GAMM_r2aic(air18_11),
                 GAMM_r2aic(air18_10),
                 GAMM_r2aic(air18_09),
                 GAMM_r2aic(air18_08),
                 GAMM_r2aic(air18_07),
                 GAMM_r2aic(air18_06),
                 GAMM_r2aic(air18_05),
                 GAMM_r2aic(air18_04),
                 GAMM_r2aic(air17_20),
                 GAMM_r2aic(air17_19),
                 GAMM_r2aic(air17_18),
                 GAMM_r2aic(air17_17),
                 GAMM_r2aic(air17_16),
                 GAMM_r2aic(air17_15),
                 GAMM_r2aic(air17_14),
                 GAMM_r2aic(air17_13),
                 GAMM_r2aic(air17_12),
                 GAMM_r2aic(air17_11),
                 GAMM_r2aic(air17_10),
                 GAMM_r2aic(air17_09),
                 GAMM_r2aic(air17_08),
                 GAMM_r2aic(air17_07),
                 GAMM_r2aic(air17_06),
                 GAMM_r2aic(air17_05),
                 GAMM_r2aic(air17_04),
                 GAMM_r2aic(air16_20),
                 GAMM_r2aic(air16_19),
                 GAMM_r2aic(air16_18),
                 GAMM_r2aic(air16_17),
                 GAMM_r2aic(air16_16),
                 GAMM_r2aic(air16_15),
                 GAMM_r2aic(air16_14),
                 GAMM_r2aic(air16_13),
                 GAMM_r2aic(air16_12),
                 GAMM_r2aic(air16_11),
                 GAMM_r2aic(air16_10),
                 GAMM_r2aic(air16_09),
                 GAMM_r2aic(air16_08),
                 GAMM_r2aic(air16_07),
                 GAMM_r2aic(air16_06),
                 GAMM_r2aic(air16_05),
                 GAMM_r2aic(air16_04),
                 GAMM_r2aic(air15_20),
                 GAMM_r2aic(air15_19),
                 GAMM_r2aic(air15_18),
                 GAMM_r2aic(air15_17),
                 GAMM_r2aic(air15_16),
                 GAMM_r2aic(air15_15),
                 GAMM_r2aic(air15_14),
                 GAMM_r2aic(air15_13),
                 GAMM_r2aic(air15_12),
                 GAMM_r2aic(air15_11),
                 GAMM_r2aic(air15_10),
                 GAMM_r2aic(air15_09),
                 GAMM_r2aic(air15_08),
                 GAMM_r2aic(air15_07),
                 GAMM_r2aic(air15_06),
                 GAMM_r2aic(air15_05),
                 GAMM_r2aic(air15_04),
                 GAMM_r2aic(air14_20),
                 GAMM_r2aic(air14_19),
                 GAMM_r2aic(air14_18),
                 GAMM_r2aic(air14_17),
                 GAMM_r2aic(air14_16),
                 GAMM_r2aic(air14_15),
                 GAMM_r2aic(air14_14),
                 GAMM_r2aic(air14_13),
                 GAMM_r2aic(air14_12),
                 GAMM_r2aic(air14_11),
                 GAMM_r2aic(air14_10),
                 GAMM_r2aic(air14_09),
                 GAMM_r2aic(air14_08),
                 GAMM_r2aic(air14_07),
                 GAMM_r2aic(air14_06),
                 GAMM_r2aic(air14_05),
                 GAMM_r2aic(air14_04),
                 GAMM_r2aic(air13_20),
                 GAMM_r2aic(air13_19),
                 GAMM_r2aic(air13_18),
                 GAMM_r2aic(air13_17),
                 GAMM_r2aic(air13_16),
                 GAMM_r2aic(air13_15),
                 GAMM_r2aic(air13_14),
                 GAMM_r2aic(air13_13),
                 GAMM_r2aic(air13_12),
                 GAMM_r2aic(air13_11),
                 GAMM_r2aic(air13_10),
                 GAMM_r2aic(air13_09),
                 GAMM_r2aic(air13_08),
                 GAMM_r2aic(air13_07),
                 GAMM_r2aic(air13_06),
                 GAMM_r2aic(air13_05),
                 GAMM_r2aic(air13_04),
                 GAMM_r2aic(air12_20),
                 GAMM_r2aic(air12_19),
                 GAMM_r2aic(air12_18),
                 GAMM_r2aic(air12_17),
                 GAMM_r2aic(air12_16),
                 GAMM_r2aic(air12_15),
                 GAMM_r2aic(air12_14),
                 GAMM_r2aic(air12_13),
                 GAMM_r2aic(air12_12),
                 GAMM_r2aic(air12_11),
                 GAMM_r2aic(air12_10),
                 GAMM_r2aic(air12_09),
                 GAMM_r2aic(air12_08),
                 GAMM_r2aic(air12_07),
                 GAMM_r2aic(air12_06),
                 GAMM_r2aic(air12_05),
                 GAMM_r2aic(air12_04),
                 GAMM_r2aic(air11_20),
                 GAMM_r2aic(air11_19),
                 GAMM_r2aic(air11_18),
                 GAMM_r2aic(air11_17),
                 GAMM_r2aic(air11_16),
                 GAMM_r2aic(air11_15),
                 GAMM_r2aic(air11_14),
                 GAMM_r2aic(air11_13),
                 GAMM_r2aic(air11_12),
                 GAMM_r2aic(air11_11),
                 GAMM_r2aic(air11_10),
                 GAMM_r2aic(air11_09),
                 GAMM_r2aic(air11_08),
                 GAMM_r2aic(air11_07),
                 GAMM_r2aic(air11_06),
                 GAMM_r2aic(air11_05),
                 GAMM_r2aic(air11_04),
                 GAMM_r2aic(air10_20),
                 GAMM_r2aic(air10_19),
                 GAMM_r2aic(air10_18),
                 GAMM_r2aic(air10_17),
                 GAMM_r2aic(air10_16),
                 GAMM_r2aic(air10_15),
                 GAMM_r2aic(air10_14),
                 GAMM_r2aic(air10_13),
                 GAMM_r2aic(air10_12),
                 GAMM_r2aic(air10_11),
                 GAMM_r2aic(air10_10),
                 GAMM_r2aic(air10_09),
                 GAMM_r2aic(air10_08),
                 GAMM_r2aic(air10_07),
                 GAMM_r2aic(air10_06),
                 GAMM_r2aic(air10_05),
                 GAMM_r2aic(air10_04),
                 GAMM_r2aic(air09_20),
                 GAMM_r2aic(air09_19),
                 GAMM_r2aic(air09_18),
                 GAMM_r2aic(air09_17),
                 GAMM_r2aic(air09_16),
                 GAMM_r2aic(air09_15),
                 GAMM_r2aic(air09_14),
                 GAMM_r2aic(air09_13),
                 GAMM_r2aic(air09_12),
                 GAMM_r2aic(air09_11),
                 GAMM_r2aic(air09_10),
                 GAMM_r2aic(air09_09),
                 GAMM_r2aic(air09_08),
                 GAMM_r2aic(air09_07),
                 GAMM_r2aic(air09_06),
                 GAMM_r2aic(air09_05),
                 GAMM_r2aic(air09_04),
                 GAMM_r2aic(air08_20),
                 GAMM_r2aic(air08_19),
                 GAMM_r2aic(air08_18),
                 GAMM_r2aic(air08_17),
                 GAMM_r2aic(air08_16),
                 GAMM_r2aic(air08_15),
                 GAMM_r2aic(air08_14),
                 GAMM_r2aic(air08_13),
                 GAMM_r2aic(air08_12),
                 GAMM_r2aic(air08_11),
                 GAMM_r2aic(air08_10),
                 GAMM_r2aic(air08_09),
                 GAMM_r2aic(air08_08),
                 GAMM_r2aic(air08_07),
                 GAMM_r2aic(air08_06),
                 GAMM_r2aic(air08_05),
                 GAMM_r2aic(air08_04),
                 GAMM_r2aic(air07_20),
                 GAMM_r2aic(air07_19),
                 GAMM_r2aic(air07_18),
                 GAMM_r2aic(air07_17),
                 GAMM_r2aic(air07_16),
                 GAMM_r2aic(air07_15),
                 GAMM_r2aic(air07_14),
                 GAMM_r2aic(air07_13),
                 GAMM_r2aic(air07_12),
                 GAMM_r2aic(air07_11),
                 GAMM_r2aic(air07_10),
                 GAMM_r2aic(air07_09),
                 GAMM_r2aic(air07_08),
                 GAMM_r2aic(air07_07),
                 GAMM_r2aic(air07_06),
                 GAMM_r2aic(air07_05),
                 GAMM_r2aic(air07_04),
                 GAMM_r2aic(air06_20),
                 GAMM_r2aic(air06_19),
                 GAMM_r2aic(air06_18),
                 GAMM_r2aic(air06_17),
                 GAMM_r2aic(air06_16),
                 GAMM_r2aic(air06_15),
                 GAMM_r2aic(air06_14),
                 GAMM_r2aic(air06_13),
                 GAMM_r2aic(air06_12),
                 GAMM_r2aic(air06_11),
                 GAMM_r2aic(air06_10),
                 GAMM_r2aic(air06_09),
                 GAMM_r2aic(air06_08),
                 GAMM_r2aic(air06_07),
                 GAMM_r2aic(air06_06),
                 GAMM_r2aic(air06_05),
                 GAMM_r2aic(air06_04),
                 GAMM_r2aic(air05_20),
                 GAMM_r2aic(air05_19),
                 GAMM_r2aic(air05_18),
                 GAMM_r2aic(air05_17),
                 GAMM_r2aic(air05_16),
                 GAMM_r2aic(air05_15),
                 GAMM_r2aic(air05_14),
                 GAMM_r2aic(air05_13),
                 GAMM_r2aic(air05_12),
                 GAMM_r2aic(air05_11),
                 GAMM_r2aic(air05_10),
                 GAMM_r2aic(air05_09),
                 GAMM_r2aic(air05_08),
                 GAMM_r2aic(air05_07),
                 GAMM_r2aic(air05_06),
                 GAMM_r2aic(air04_20),
                 GAMM_r2aic(air04_19),
                 GAMM_r2aic(air04_18),
                 GAMM_r2aic(air04_17),
                 GAMM_r2aic(air04_16),
                 GAMM_r2aic(air04_15),
                 GAMM_r2aic(air04_14),
                 GAMM_r2aic(air04_13))

output1$month <- "Warmest month" #add month
output1$location <- "air" #add temp origin
output1$resp.var <- "mean temp" # add response variable

# cleanup models:
rm(list = ls(pattern = "air"))
```

#### Coldest month:

```{r}
# only Forest density

air20_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air19_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air18_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air17_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air16_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air15_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air14_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air13_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air12_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air11_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air10_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air09_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air08_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air07_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air06_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air05_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air04_0 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

# only broadleaves

air0_20 <- gamm4(air_meanoff_ERA5~s(perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air0_19 <- gamm4(air_meanoff_ERA5~s(perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air0_18 <- gamm4(air_meanoff_ERA5~s(perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air0_17 <- gamm4(air_meanoff_ERA5~s(perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air0_16 <- gamm4(air_meanoff_ERA5~s(perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air0_15 <- gamm4(air_meanoff_ERA5~s(perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air0_14 <- gamm4(air_meanoff_ERA5~s(perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air0_13 <- gamm4(air_meanoff_ERA5~s(perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air0_12 <- gamm4(air_meanoff_ERA5~s(perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air0_11 <- gamm4(air_meanoff_ERA5~s(perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air0_10 <- gamm4(air_meanoff_ERA5~s(perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air0_09 <- gamm4(air_meanoff_ERA5~s(perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air0_08 <- gamm4(air_meanoff_ERA5~s(perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air0_07 <- gamm4(air_meanoff_ERA5~s(perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air0_06 <- gamm4(air_meanoff_ERA5~s(perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air0_05 <- gamm4(air_meanoff_ERA5~s(perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

#air0_04 <- gamm4(air_meanoff_ERA5~s(perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

# all combinations

air20_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air20_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air20_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air20_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air20_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air20_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air20_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air20_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air20_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air20_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air20_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air20_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air20_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air20_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air20_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air20_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air20_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_20m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air19_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air19_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air19_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air19_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air19_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air19_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air19_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air19_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air19_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air19_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air19_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air19_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air19_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air19_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air19_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air19_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air19_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_19m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air18_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air18_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air18_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air18_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air18_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air18_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air18_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air18_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air18_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air18_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air18_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air18_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air18_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air18_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air18_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air18_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air18_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_18m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air17_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air17_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air17_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air17_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air17_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air17_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air17_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air17_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air17_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air17_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air17_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air17_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air17_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air17_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air17_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air17_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air17_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_17m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air16_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air16_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air16_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air16_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air16_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air16_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air16_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air16_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air16_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air16_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air16_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air16_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air16_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air16_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air16_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air16_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air16_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_16m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air15_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air15_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air15_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air15_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air15_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air15_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air15_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air15_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air15_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air15_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air15_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air15_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air15_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air15_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air15_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air15_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air15_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_15m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air14_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air14_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air14_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air14_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air14_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air14_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air14_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air14_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air14_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air14_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air14_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air14_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air14_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air14_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air14_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air14_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air14_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_14m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air13_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air13_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air13_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air13_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air13_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air13_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air13_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air13_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air13_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air13_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air13_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air13_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air13_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air13_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air13_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air13_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air13_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_13m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air12_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air12_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air12_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air12_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air12_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air12_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air12_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air12_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air12_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air12_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air12_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air12_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air12_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air12_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air12_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air12_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air12_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_12m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air11_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air11_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air11_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air11_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air11_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air11_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air11_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air11_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air11_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air11_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air11_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air11_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air11_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air11_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air11_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air11_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air11_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_11m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air10_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air10_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air10_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air10_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air10_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air10_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air10_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air10_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air10_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air10_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air10_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air10_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air10_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air10_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air10_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air10_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air10_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_10m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air09_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air09_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air09_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air09_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air09_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air09_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air09_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air09_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air09_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air09_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air09_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air09_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air09_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air09_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air09_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air09_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air09_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_09m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air08_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air08_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air08_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air08_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air08_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air08_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air08_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air08_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air08_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air08_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air08_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air08_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air08_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air08_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air08_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air08_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air08_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_08m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air07_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air07_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air07_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air07_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air07_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air07_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air07_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air07_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air07_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air07_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air07_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air07_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air07_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air07_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air07_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air07_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air07_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_07m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air06_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air06_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air06_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air06_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air06_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air06_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air06_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air06_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air06_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air06_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air06_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air06_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air06_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air06_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air06_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air06_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air06_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_06m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air05_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air05_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air05_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air05_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air05_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air05_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air05_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air05_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air05_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air05_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air05_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air05_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air05_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air05_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air05_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

#air05_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

#air05_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_05m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air04_20 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_20m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air04_19 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_19m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air04_18 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_18m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air04_17 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_17m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air04_16 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_16m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air04_15 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_15m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air04_14 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_14m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

air04_13 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_13m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

#air04_12 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_12m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

#air04_11 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_11m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

#air04_10 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_10m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

#air04_09 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_09m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

#air04_08 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_08m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

#air04_07 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_07m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

#air04_06 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_06m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

#air04_05 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_05m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)

#air04_04 <- gamm4(air_meanoff_ERA5~s(Basal_Area_04m, perc_broad_04m) + s(autocorr), random = ~ (1|site:Plot), data = tree.temp.a.jan.arville)


# Save models
output2 <- rbind(GAMM_r2aic(air20_0),
                 GAMM_r2aic(air19_0),
                 GAMM_r2aic(air18_0),
                 GAMM_r2aic(air17_0),
                 GAMM_r2aic(air16_0),
                 GAMM_r2aic(air15_0),
                 GAMM_r2aic(air14_0),
                 GAMM_r2aic(air13_0),
                 GAMM_r2aic(air12_0),
                 GAMM_r2aic(air11_0),
                 GAMM_r2aic(air10_0),
                 GAMM_r2aic(air09_0),
                 GAMM_r2aic(air08_0),
                 GAMM_r2aic(air07_0),
                 GAMM_r2aic(air06_0),
                 GAMM_r2aic(air05_0),
                 GAMM_r2aic(air04_0),
                 GAMM_r2aic(air0_20),
                 GAMM_r2aic(air0_19),
                 GAMM_r2aic(air0_18),
                 GAMM_r2aic(air0_17),
                 GAMM_r2aic(air0_16),
                 GAMM_r2aic(air0_15),
                 GAMM_r2aic(air0_14),
                 GAMM_r2aic(air0_13),
                 GAMM_r2aic(air0_12),
                 GAMM_r2aic(air0_11),
                 GAMM_r2aic(air0_10),
                 GAMM_r2aic(air0_09),
                 GAMM_r2aic(air0_08),
                 GAMM_r2aic(air0_07),
                 GAMM_r2aic(air0_06),
                 GAMM_r2aic(air0_05),
                 GAMM_r2aic(air20_20),
                 GAMM_r2aic(air20_19),
                 GAMM_r2aic(air20_18),
                 GAMM_r2aic(air20_17),
                 GAMM_r2aic(air20_16),
                 GAMM_r2aic(air20_15),
                 GAMM_r2aic(air20_14),
                 GAMM_r2aic(air20_13),
                 GAMM_r2aic(air20_12),
                 GAMM_r2aic(air20_11),
                 GAMM_r2aic(air20_10),
                 GAMM_r2aic(air20_09),
                 GAMM_r2aic(air20_08),
                 GAMM_r2aic(air20_07),
                 GAMM_r2aic(air20_06),
                 GAMM_r2aic(air20_05),
                 GAMM_r2aic(air20_04),
                 GAMM_r2aic(air19_20),
                 GAMM_r2aic(air19_19),
                 GAMM_r2aic(air19_18),
                 GAMM_r2aic(air19_17),
                 GAMM_r2aic(air19_16),
                 GAMM_r2aic(air19_15),
                 GAMM_r2aic(air19_14),
                 GAMM_r2aic(air19_13),
                 GAMM_r2aic(air19_12),
                 GAMM_r2aic(air19_11),
                 GAMM_r2aic(air19_10),
                 GAMM_r2aic(air19_09),
                 GAMM_r2aic(air19_08),
                 GAMM_r2aic(air19_07),
                 GAMM_r2aic(air19_06),
                 GAMM_r2aic(air19_05),
                 GAMM_r2aic(air19_04),
                 GAMM_r2aic(air18_20),
                 GAMM_r2aic(air18_19),
                 GAMM_r2aic(air18_18),
                 GAMM_r2aic(air18_17),
                 GAMM_r2aic(air18_16),
                 GAMM_r2aic(air18_15),
                 GAMM_r2aic(air18_14),
                 GAMM_r2aic(air18_13),
                 GAMM_r2aic(air18_12),
                 GAMM_r2aic(air18_11),
                 GAMM_r2aic(air18_10),
                 GAMM_r2aic(air18_09),
                 GAMM_r2aic(air18_08),
                 GAMM_r2aic(air18_07),
                 GAMM_r2aic(air18_06),
                 GAMM_r2aic(air18_05),
                 GAMM_r2aic(air18_04),
                 GAMM_r2aic(air17_20),
                 GAMM_r2aic(air17_19),
                 GAMM_r2aic(air17_18),
                 GAMM_r2aic(air17_17),
                 GAMM_r2aic(air17_16),
                 GAMM_r2aic(air17_15),
                 GAMM_r2aic(air17_14),
                 GAMM_r2aic(air17_13),
                 GAMM_r2aic(air17_12),
                 GAMM_r2aic(air17_11),
                 GAMM_r2aic(air17_10),
                 GAMM_r2aic(air17_09),
                 GAMM_r2aic(air17_08),
                 GAMM_r2aic(air17_07),
                 GAMM_r2aic(air17_06),
                 GAMM_r2aic(air17_05),
                 GAMM_r2aic(air17_04),
                 GAMM_r2aic(air16_20),
                 GAMM_r2aic(air16_19),
                 GAMM_r2aic(air16_18),
                 GAMM_r2aic(air16_17),
                 GAMM_r2aic(air16_16),
                 GAMM_r2aic(air16_15),
                 GAMM_r2aic(air16_14),
                 GAMM_r2aic(air16_13),
                 GAMM_r2aic(air16_12),
                 GAMM_r2aic(air16_11),
                 GAMM_r2aic(air16_10),
                 GAMM_r2aic(air16_09),
                 GAMM_r2aic(air16_08),
                 GAMM_r2aic(air16_07),
                 GAMM_r2aic(air16_06),
                 GAMM_r2aic(air16_05),
                 GAMM_r2aic(air16_04),
                 GAMM_r2aic(air15_20),
                 GAMM_r2aic(air15_19),
                 GAMM_r2aic(air15_18),
                 GAMM_r2aic(air15_17),
                 GAMM_r2aic(air15_16),
                 GAMM_r2aic(air15_15),
                 GAMM_r2aic(air15_14),
                 GAMM_r2aic(air15_13),
                 GAMM_r2aic(air15_12),
                 GAMM_r2aic(air15_11),
                 GAMM_r2aic(air15_10),
                 GAMM_r2aic(air15_09),
                 GAMM_r2aic(air15_08),
                 GAMM_r2aic(air15_07),
                 GAMM_r2aic(air15_06),
                 GAMM_r2aic(air15_05),
                 GAMM_r2aic(air15_04),
                 GAMM_r2aic(air14_20),
                 GAMM_r2aic(air14_19),
                 GAMM_r2aic(air14_18),
                 GAMM_r2aic(air14_17),
                 GAMM_r2aic(air14_16),
                 GAMM_r2aic(air14_15),
                 GAMM_r2aic(air14_14),
                 GAMM_r2aic(air14_13),
                 GAMM_r2aic(air14_12),
                 GAMM_r2aic(air14_11),
                 GAMM_r2aic(air14_10),
                 GAMM_r2aic(air14_09),
                 GAMM_r2aic(air14_08),
                 GAMM_r2aic(air14_07),
                 GAMM_r2aic(air14_06),
                 GAMM_r2aic(air14_05),
                 GAMM_r2aic(air14_04),
                 GAMM_r2aic(air13_20),
                 GAMM_r2aic(air13_19),
                 GAMM_r2aic(air13_18),
                 GAMM_r2aic(air13_17),
                 GAMM_r2aic(air13_16),
                 GAMM_r2aic(air13_15),
                 GAMM_r2aic(air13_14),
                 GAMM_r2aic(air13_13),
                 GAMM_r2aic(air13_12),
                 GAMM_r2aic(air13_11),
                 GAMM_r2aic(air13_10),
                 GAMM_r2aic(air13_09),
                 GAMM_r2aic(air13_08),
                 GAMM_r2aic(air13_07),
                 GAMM_r2aic(air13_06),
                 GAMM_r2aic(air13_05),
                 GAMM_r2aic(air13_04),
                 GAMM_r2aic(air12_20),
                 GAMM_r2aic(air12_19),
                 GAMM_r2aic(air12_18),
                 GAMM_r2aic(air12_17),
                 GAMM_r2aic(air12_16),
                 GAMM_r2aic(air12_15),
                 GAMM_r2aic(air12_14),
                 GAMM_r2aic(air12_13),
                 GAMM_r2aic(air12_12),
                 GAMM_r2aic(air12_11),
                 GAMM_r2aic(air12_10),
                 GAMM_r2aic(air12_09),
                 GAMM_r2aic(air12_08),
                 GAMM_r2aic(air12_07),
                 GAMM_r2aic(air12_06),
                 GAMM_r2aic(air12_05),
                 GAMM_r2aic(air12_04),
                 GAMM_r2aic(air11_20),
                 GAMM_r2aic(air11_19),
                 GAMM_r2aic(air11_18),
                 GAMM_r2aic(air11_17),
                 GAMM_r2aic(air11_16),
                 GAMM_r2aic(air11_15),
                 GAMM_r2aic(air11_14),
                 GAMM_r2aic(air11_13),
                 GAMM_r2aic(air11_12),
                 GAMM_r2aic(air11_11),
                 GAMM_r2aic(air11_10),
                 GAMM_r2aic(air11_09),
                 GAMM_r2aic(air11_08),
                 GAMM_r2aic(air11_07),
                 GAMM_r2aic(air11_06),
                 GAMM_r2aic(air11_05),
                 GAMM_r2aic(air11_04),
                 GAMM_r2aic(air10_20),
                 GAMM_r2aic(air10_19),
                 GAMM_r2aic(air10_18),
                 GAMM_r2aic(air10_17),
                 GAMM_r2aic(air10_16),
                 GAMM_r2aic(air10_15),
                 GAMM_r2aic(air10_14),
                 GAMM_r2aic(air10_13),
                 GAMM_r2aic(air10_12),
                 GAMM_r2aic(air10_11),
                 GAMM_r2aic(air10_10),
                 GAMM_r2aic(air10_09),
                 GAMM_r2aic(air10_08),
                 GAMM_r2aic(air10_07),
                 GAMM_r2aic(air10_06),
                 GAMM_r2aic(air10_05),
                 GAMM_r2aic(air10_04),
                 GAMM_r2aic(air09_20),
                 GAMM_r2aic(air09_19),
                 GAMM_r2aic(air09_18),
                 GAMM_r2aic(air09_17),
                 GAMM_r2aic(air09_16),
                 GAMM_r2aic(air09_15),
                 GAMM_r2aic(air09_14),
                 GAMM_r2aic(air09_13),
                 GAMM_r2aic(air09_12),
                 GAMM_r2aic(air09_11),
                 GAMM_r2aic(air09_10),
                 GAMM_r2aic(air09_09),
                 GAMM_r2aic(air09_08),
                 GAMM_r2aic(air09_07),
                 GAMM_r2aic(air09_06),
                 GAMM_r2aic(air09_05),
                 GAMM_r2aic(air09_04),
                 GAMM_r2aic(air08_20),
                 GAMM_r2aic(air08_19),
                 GAMM_r2aic(air08_18),
                 GAMM_r2aic(air08_17),
                 GAMM_r2aic(air08_16),
                 GAMM_r2aic(air08_15),
                 GAMM_r2aic(air08_14),
                 GAMM_r2aic(air08_13),
                 GAMM_r2aic(air08_12),
                 GAMM_r2aic(air08_11),
                 GAMM_r2aic(air08_10),
                 GAMM_r2aic(air08_09),
                 GAMM_r2aic(air08_08),
                 GAMM_r2aic(air08_07),
                 GAMM_r2aic(air08_06),
                 GAMM_r2aic(air08_05),
                 GAMM_r2aic(air08_04),
                 GAMM_r2aic(air07_20),
                 GAMM_r2aic(air07_19),
                 GAMM_r2aic(air07_18),
                 GAMM_r2aic(air07_17),
                 GAMM_r2aic(air07_16),
                 GAMM_r2aic(air07_15),
                 GAMM_r2aic(air07_14),
                 GAMM_r2aic(air07_13),
                 GAMM_r2aic(air07_12),
                 GAMM_r2aic(air07_11),
                 GAMM_r2aic(air07_10),
                 GAMM_r2aic(air07_09),
                 GAMM_r2aic(air07_08),
                 GAMM_r2aic(air07_07),
                 GAMM_r2aic(air07_06),
                 GAMM_r2aic(air07_05),
                 GAMM_r2aic(air07_04),
                 GAMM_r2aic(air06_20),
                 GAMM_r2aic(air06_19),
                 GAMM_r2aic(air06_18),
                 GAMM_r2aic(air06_17),
                 GAMM_r2aic(air06_16),
                 GAMM_r2aic(air06_15),
                 GAMM_r2aic(air06_14),
                 GAMM_r2aic(air06_13),
                 GAMM_r2aic(air06_12),
                 GAMM_r2aic(air06_11),
                 GAMM_r2aic(air06_10),
                 GAMM_r2aic(air06_09),
                 GAMM_r2aic(air06_08),
                 GAMM_r2aic(air06_07),
                 GAMM_r2aic(air06_06),
                 GAMM_r2aic(air06_05),
                 GAMM_r2aic(air06_04),
                 GAMM_r2aic(air05_20),
                 GAMM_r2aic(air05_19),
                 GAMM_r2aic(air05_18),
                 GAMM_r2aic(air05_17),
                 GAMM_r2aic(air05_16),
                 GAMM_r2aic(air05_15),
                 GAMM_r2aic(air05_14),
                 GAMM_r2aic(air05_13),
                 GAMM_r2aic(air05_12),
                 GAMM_r2aic(air05_11),
                 GAMM_r2aic(air05_10),
                 GAMM_r2aic(air05_09),
                 GAMM_r2aic(air05_08),
                 GAMM_r2aic(air05_07),
                 GAMM_r2aic(air05_06),
                 GAMM_r2aic(air04_20),
                 GAMM_r2aic(air04_19),
                 GAMM_r2aic(air04_18),
                 GAMM_r2aic(air04_17),
                 GAMM_r2aic(air04_16),
                 GAMM_r2aic(air04_15),
                 GAMM_r2aic(air04_14),
                 GAMM_r2aic(air04_13))

output2$month <- "Coldest month" #add month
output2$location <- "air" #add temp origin
output2$resp.var <- "mean temp" # add response variable

# cleanup models:
rm(list = ls(pattern = "air"))
```

### Save models results:

```{r}
radii.results.arville <- rbind(output1, output2)

radii.results.arville$source <- "ERA5"

write.csv2(radii.results.arville, file = "./DATASETS/Table_S4.csv", row.names = FALSE)
```
